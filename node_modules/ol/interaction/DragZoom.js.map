{"version":3,"file":"DragZoom.js","sources":["../../../src/ol/interaction/DragZoom.js"],"sourcesContent":["/**\n * @module ol/interaction/DragZoom\n */\nimport {easeOut} from '../easing.js';\nimport {shiftKeyOnly} from '../events/condition.js';\nimport {createOrUpdateFromCoordinates, getBottomLeft, getCenter, getTopRight, scaleFromCenter} from '../extent.js';\nimport DragBox from './DragBox.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-dragzoom'] CSS class name for styling the\n * box.\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~shiftKeyOnly}.\n * @property {number} [duration=200] Animation duration in milliseconds.\n * @property {boolean} [out=false] Use interaction for zooming out.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when a key, shift by default, is held down.\n *\n * To change the style of the box, use CSS and the `.ol-dragzoom` selector, or\n * your custom one configured with `className`.\n * @api\n */\nclass DragZoom extends DragBox {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    const options = opt_options ? opt_options : {};\n\n    const condition = options.condition ? options.condition : shiftKeyOnly;\n\n    super({\n      condition: condition,\n      className: options.className || 'ol-dragzoom',\n      onBoxEnd: onBoxEnd\n    });\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 200;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.out_ = options.out !== undefined ? options.out : false;\n  }\n}\n\n\n/**\n * @this {DragZoom}\n */\nfunction onBoxEnd() {\n  const map = this.getMap();\n  const view = /** @type {!import(\"../View.js\").default} */ (map.getView());\n  const size = /** @type {!import(\"../size.js\").Size} */ (map.getSize());\n  let extent = this.getGeometry().getExtent();\n\n  if (this.out_) {\n    const mapExtent = view.calculateExtent(size);\n    const boxPixelExtent = createOrUpdateFromCoordinates([\n      map.getPixelFromCoordinate(getBottomLeft(extent)),\n      map.getPixelFromCoordinate(getTopRight(extent))]);\n    const factor = view.getResolutionForExtent(boxPixelExtent, size);\n\n    scaleFromCenter(mapExtent, 1 / factor);\n    extent = mapExtent;\n  }\n\n  const resolution = view.constrainResolution(\n    view.getResolutionForExtent(extent, size));\n\n  let center = getCenter(extent);\n  center = view.constrainCenter(center);\n\n  view.animate({\n    resolution: resolution,\n    center: center,\n    duration: this.duration_,\n    easing: easeOut\n  });\n}\n\n\nexport default DragZoom;\n"],"names":["const","super","let"],"mappings":"AAAA;;;AAGA,QAAQ,OAAO,OAAO,cAAc,CAAC;AACrC,QAAQ,YAAY,OAAO,wBAAwB,CAAC;AACpD,QAAQ,6BAA6B,EAAE,aAAa,EAAE,SAAS,EAAE,WAAW,EAAE,eAAe,OAAO,cAAc,CAAC;AACnH,OAAO,OAAO,MAAM,cAAc,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BnC,IAAM,QAAQ,GAAgB;EAI5B,iBAAW,CAAC,WAAW,EAAE;IACvBA,GAAK,CAAC,OAAO,GAAG,WAAW,GAAG,WAAW,GAAG,EAAE,CAAC;;IAE/CA,GAAK,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,GAAG,YAAY,CAAC;;IAEvEC,YAAK,OAAC;MACJ,SAAS,EAAE,SAAS;MACpB,SAAS,EAAE,OAAO,CAAC,SAAS,IAAI,aAAa;MAC7C,QAAQ,EAAE,QAAQ;KACnB,CAAC,CAAC;;;;;;IAMH,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,QAAQ,KAAK,SAAS,GAAG,OAAO,CAAC,QAAQ,GAAG,GAAG,CAAC;;;;;;IAMzE,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC,GAAG,KAAK,SAAS,GAAG,OAAO,CAAC,GAAG,GAAG,KAAK,CAAC;;;;;GAC7D;;;EA1BoB,UA2BtB;;;;;;AAMD,SAAS,QAAQ,GAAG;EAClBD,GAAK,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;EAC1BA,GAAK,CAAC,IAAI,gDAAgD,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;EAC1EA,GAAK,CAAC,IAAI,6CAA6C,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;EACvEE,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,SAAS,EAAE,CAAC;;EAE5C,IAAI,IAAI,CAAC,IAAI,EAAE;IACbF,GAAK,CAAC,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IAC7CA,GAAK,CAAC,cAAc,GAAG,6BAA6B,CAAC;MACnD,GAAG,CAAC,sBAAsB,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;MACjD,GAAG,CAAC,sBAAsB,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;IACpDA,GAAK,CAAC,MAAM,GAAG,IAAI,CAAC,sBAAsB,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;;IAEjE,eAAe,CAAC,SAAS,EAAE,CAAC,GAAG,MAAM,CAAC,CAAC;IACvC,MAAM,GAAG,SAAS,CAAC;GACpB;;EAEDA,GAAK,CAAC,UAAU,GAAG,IAAI,CAAC,mBAAmB;IACzC,IAAI,CAAC,sBAAsB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC;;EAE7CE,GAAG,CAAC,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC;EAC/B,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;;EAEtC,IAAI,CAAC,OAAO,CAAC;IACX,UAAU,EAAE,UAAU;IACtB,MAAM,EAAE,MAAM;IACd,QAAQ,EAAE,IAAI,CAAC,SAAS;IACxB,MAAM,EAAE,OAAO;GAChB,CAAC,CAAC;CACJ;;;AAGD,eAAe,QAAQ,CAAC;"}