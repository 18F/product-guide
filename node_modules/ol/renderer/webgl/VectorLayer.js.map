{"version":3,"file":"VectorLayer.js","sources":["../../../../src/ol/renderer/webgl/VectorLayer.js"],"sourcesContent":["/**\n * @module ol/renderer/webgl/VectorLayer\n */\nimport {getUid} from '../../util.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {buffer, containsExtent, createEmpty} from '../../extent.js';\nimport WebGLReplayGroup from '../../render/webgl/ReplayGroup.js';\nimport {defaultOrder as defaultRenderOrder, getTolerance as getRenderTolerance, getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\nimport WebGLLayerRenderer from './Layer.js';\nimport {apply as applyTransform} from '../../transform.js';\n\n\n/**\n * @classdesc\n * WebGL renderer for vector layers.\n * @api\n */\nclass WebGLVectorLayerRenderer extends WebGLLayerRenderer {\n\n  /**\n   * @param {import(\"./Map.js\").default} mapRenderer Map renderer.\n   * @param {import(\"../../layer/Vector.js\").default} vectorLayer Vector layer.\n   */\n  constructor(mapRenderer, vectorLayer) {\n\n    super(mapRenderer, vectorLayer);\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.dirty_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.renderedRevision_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.renderedResolution_ = NaN;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.renderedExtent_ = createEmpty();\n\n    /**\n     * @private\n     * @type {function(import(\"../../Feature.js\").default, import(\"../../Feature.js\").default): number|null}\n     */\n    this.renderedRenderOrder_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../../render/webgl/ReplayGroup.js\").default}\n     */\n    this.replayGroup_ = null;\n\n    /**\n     * The last layer state.\n     * @private\n     * @type {?import(\"../../layer/Layer.js\").State}\n     */\n    this.layerState_ = null;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  composeFrame(frameState, layerState, context) {\n    this.layerState_ = layerState;\n    const viewState = frameState.viewState;\n    const replayGroup = this.replayGroup_;\n    const size = frameState.size;\n    const pixelRatio = frameState.pixelRatio;\n    const gl = this.mapRenderer.getGL();\n    if (replayGroup && !replayGroup.isEmpty()) {\n      gl.enable(gl.SCISSOR_TEST);\n      gl.scissor(0, 0, size[0] * pixelRatio, size[1] * pixelRatio);\n      replayGroup.replay(context,\n        viewState.center, viewState.resolution, viewState.rotation,\n        size, pixelRatio, layerState.opacity,\n        layerState.managed ? frameState.skippedFeatureUids : {});\n      gl.disable(gl.SCISSOR_TEST);\n    }\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    const replayGroup = this.replayGroup_;\n    if (replayGroup) {\n      const context = this.mapRenderer.getContext();\n      replayGroup.getDeleteResourcesFunction(context)();\n      this.replayGroup_ = null;\n    }\n    super.disposeInternal();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, thisArg) {\n    if (!this.replayGroup_ || !this.layerState_) {\n      return undefined;\n    } else {\n      const context = this.mapRenderer.getContext();\n      const viewState = frameState.viewState;\n      const layer = this.getLayer();\n      const layerState = this.layerState_;\n      /** @type {!Object<string, boolean>} */\n      const features = {};\n      return this.replayGroup_.forEachFeatureAtCoordinate(coordinate,\n        context, viewState.center, viewState.resolution, viewState.rotation,\n        frameState.size, frameState.pixelRatio, layerState.opacity,\n        {},\n        /**\n         * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n         * @return {?} Callback result.\n         */\n        function(feature) {\n          const key = getUid(feature);\n          if (!(key in features)) {\n            features[key] = true;\n            return callback.call(thisArg, feature, layer);\n          }\n        });\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  hasFeatureAtCoordinate(coordinate, frameState) {\n    if (!this.replayGroup_ || !this.layerState_) {\n      return false;\n    } else {\n      const context = this.mapRenderer.getContext();\n      const viewState = frameState.viewState;\n      const layerState = this.layerState_;\n      return this.replayGroup_.hasFeatureAtCoordinate(coordinate,\n        context, viewState.center, viewState.resolution, viewState.rotation,\n        frameState.size, frameState.pixelRatio, layerState.opacity,\n        frameState.skippedFeatureUids);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  forEachLayerAtPixel(pixel, frameState, callback, thisArg) {\n    const coordinate = applyTransform(\n      frameState.pixelToCoordinateTransform, pixel.slice());\n    const hasFeature = this.hasFeatureAtCoordinate(coordinate, frameState);\n\n    if (hasFeature) {\n      return callback.call(thisArg, this.getLayer(), null);\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * Handle changes in image style state.\n   * @param {import(\"../../events/Event.js\").default} event Image style change event.\n   * @private\n   */\n  handleStyleImageChange_(event) {\n    this.renderIfReadyAndVisible();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  prepareFrame(frameState, layerState, context) {\n    const vectorLayer = /** @type {import(\"../../layer/Vector.js\").default} */ (this.getLayer());\n    const vectorSource = /** @type {import(\"../../source/Vector.js\").default} */ (vectorLayer.getSource());\n\n    const animating = frameState.viewHints[ViewHint.ANIMATING];\n    const interacting = frameState.viewHints[ViewHint.INTERACTING];\n    const updateWhileAnimating = vectorLayer.getUpdateWhileAnimating();\n    const updateWhileInteracting = vectorLayer.getUpdateWhileInteracting();\n\n    if (!this.dirty_ && (!updateWhileAnimating && animating) ||\n        (!updateWhileInteracting && interacting)) {\n      return true;\n    }\n\n    const frameStateExtent = frameState.extent;\n    const viewState = frameState.viewState;\n    const projection = viewState.projection;\n    const resolution = viewState.resolution;\n    const pixelRatio = frameState.pixelRatio;\n    const vectorLayerRevision = vectorLayer.getRevision();\n    const vectorLayerRenderBuffer = vectorLayer.getRenderBuffer();\n    let vectorLayerRenderOrder = vectorLayer.getRenderOrder();\n\n    if (vectorLayerRenderOrder === undefined) {\n      vectorLayerRenderOrder = defaultRenderOrder;\n    }\n\n    const extent = buffer(frameStateExtent,\n      vectorLayerRenderBuffer * resolution);\n\n    if (!this.dirty_ &&\n        this.renderedResolution_ == resolution &&\n        this.renderedRevision_ == vectorLayerRevision &&\n        this.renderedRenderOrder_ == vectorLayerRenderOrder &&\n        containsExtent(this.renderedExtent_, extent)) {\n      return true;\n    }\n\n    if (this.replayGroup_) {\n      frameState.postRenderFunctions.push(\n        this.replayGroup_.getDeleteResourcesFunction(context));\n    }\n\n    this.dirty_ = false;\n\n    const replayGroup = new WebGLReplayGroup(\n      getRenderTolerance(resolution, pixelRatio),\n      extent, vectorLayer.getRenderBuffer());\n    vectorSource.loadFeatures(extent, resolution, projection);\n    /**\n     * @param {import(\"../../Feature.js\").default} feature Feature.\n     * @this {WebGLVectorLayerRenderer}\n     */\n    const render = function(feature) {\n      let styles;\n      const styleFunction = feature.getStyleFunction() || vectorLayer.getStyleFunction();\n      if (styleFunction) {\n        styles = styleFunction(feature, resolution);\n      }\n      if (styles) {\n        const dirty = this.renderFeature(\n          feature, resolution, pixelRatio, styles, replayGroup);\n        this.dirty_ = this.dirty_ || dirty;\n      }\n    }.bind(this);\n    if (vectorLayerRenderOrder) {\n      /** @type {Array<import(\"../../Feature.js\").default>} */\n      const features = [];\n      vectorSource.forEachFeatureInExtent(extent,\n        /**\n         * @param {import(\"../../Feature.js\").default} feature Feature.\n         */\n        function(feature) {\n          features.push(feature);\n        });\n      features.sort(vectorLayerRenderOrder);\n      features.forEach(render.bind(this));\n    } else {\n      vectorSource.forEachFeatureInExtent(extent, render);\n    }\n    replayGroup.finish(context);\n\n    this.renderedResolution_ = resolution;\n    this.renderedRevision_ = vectorLayerRevision;\n    this.renderedRenderOrder_ = vectorLayerRenderOrder;\n    this.renderedExtent_ = extent;\n    this.replayGroup_ = replayGroup;\n\n    return true;\n  }\n\n  /**\n   * @param {import(\"../../Feature.js\").default} feature Feature.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../style/Style.js\").default|Array<import(\"../../style/Style.js\").default>} styles The style or array of\n   *     styles.\n   * @param {import(\"../../render/webgl/ReplayGroup.js\").default} replayGroup Replay group.\n   * @return {boolean} `true` if an image is loading.\n   */\n  renderFeature(feature, resolution, pixelRatio, styles, replayGroup) {\n    if (!styles) {\n      return false;\n    }\n    let loading = false;\n    if (Array.isArray(styles)) {\n      for (let i = styles.length - 1, ii = 0; i >= ii; --i) {\n        loading = renderFeature(\n          replayGroup, feature, styles[i],\n          getSquaredRenderTolerance(resolution, pixelRatio),\n          this.handleStyleImageChange_, this) || loading;\n      }\n    } else {\n      loading = renderFeature(\n        replayGroup, feature, styles,\n        getSquaredRenderTolerance(resolution, pixelRatio),\n        this.handleStyleImageChange_, this) || loading;\n    }\n    return loading;\n  }\n}\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {import(\"../../layer/Layer.js\").default} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nWebGLVectorLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {import(\"../Map.js\").default} mapRenderer The map renderer.\n * @param {import(\"../../layer/Layer.js\").default} layer The layer to be rendererd.\n * @return {WebGLVectorLayerRenderer} The layer renderer.\n */\nWebGLVectorLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new WebGLVectorLayerRenderer(\n    /** @type {import(\"./Map.js\").default} */ (mapRenderer),\n    /** @type {import(\"../../layer/Vector.js\").default} */ (layer)\n  );\n};\n\n\nexport default WebGLVectorLayerRenderer;\n"],"names":["super","const","let"],"mappings":"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"}