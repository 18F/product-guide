{"version":3,"file":"TileCache.js","sources":["../../src/ol/TileCache.js"],"sourcesContent":["/**\n * @module ol/TileCache\n */\nimport LRUCache from './structs/LRUCache.js';\nimport {fromKey, getKey} from './tilecoord.js';\n\nclass TileCache extends LRUCache {\n\n  /**\n   * @param {number=} opt_highWaterMark High water mark.\n   */\n  constructor(opt_highWaterMark) {\n\n    super(opt_highWaterMark);\n\n  }\n\n  /**\n   * @param {!Object<string, import(\"./TileRange.js\").default>} usedTiles Used tiles.\n   */\n  expireCache(usedTiles) {\n    while (this.canExpireCache()) {\n      const tile = this.peekLast();\n      const zKey = tile.tileCoord[0].toString();\n      if (zKey in usedTiles && usedTiles[zKey].contains(tile.tileCoord)) {\n        break;\n      } else {\n        this.pop().dispose();\n      }\n    }\n  }\n\n  /**\n   * Prune all tiles from the cache that don't have the same z as the newest tile.\n   */\n  pruneExceptNewestZ() {\n    if (this.getCount() === 0) {\n      return;\n    }\n    const key = this.peekFirstKey();\n    const tileCoord = fromKey(key);\n    const z = tileCoord[0];\n    this.forEach(function(tile) {\n      if (tile.tileCoord[0] !== z) {\n        this.remove(getKey(tile.tileCoord));\n        tile.dispose();\n      }\n    }, this);\n  }\n}\n\n\nexport default TileCache;\n"],"names":["super","const"],"mappings":"AAAA;;;AAGA,OAAO,QAAQ,MAAM,uBAAuB,CAAC;AAC7C,QAAQ,OAAO,EAAE,MAAM,OAAO,gBAAgB,CAAC;;AAE/C,IAAM,SAAS,GAAiB;EAK9B,kBAAW,CAAC,iBAAiB,EAAE;;IAE7BA,aAAK,OAAC,iBAAiB,CAAC,CAAC;;;;;;8CAE1B;;;;;sBAKD,mCAAW,CAAC,SAAS,EAAE;IACrB,OAAO,IAAI,CAAC,cAAc,EAAE,EAAE;MAC5BC,GAAK,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;MAC7BA,GAAK,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC;MAC1C,IAAI,IAAI,IAAI,SAAS,IAAI,SAAS,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;QACjE,MAAM;OACP,MAAM;QACL,IAAI,CAAC,GAAG,EAAE,CAAC,OAAO,EAAE,CAAC;OACtB;KACF;IACF;;;;;sBAKD,iDAAkB,GAAG;IACnB,IAAI,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,EAAE;MACzB,OAAO;KACR;IACDA,GAAK,CAAC,GAAG,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;IAChCA,GAAK,CAAC,SAAS,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;IAC/BA,GAAK,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;IACvB,IAAI,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE;MAC1B,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;QAC3B,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;QACpC,IAAI,CAAC,OAAO,EAAE,CAAC;OAChB;KACF,EAAE,IAAI,CAAC,CAAC;GACV;;;EA1CqB,WA2CvB;;;AAGD,eAAe,SAAS,CAAC;"}