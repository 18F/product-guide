{"version":3,"file":"KML.js","sources":["../../../src/ol/format/KML.js"],"sourcesContent":["/**\n * @module ol/format/KML\n */\nimport Feature from '../Feature.js';\nimport {extend, includes} from '../array.js';\nimport {assert} from '../asserts.js';\nimport {asArray} from '../color.js';\nimport {transformWithOptions} from './Feature.js';\nimport XMLFeature from './XMLFeature.js';\nimport {readDecimal, readBoolean, readString, writeStringTextNode, writeCDATASection, writeDecimalTextNode, writeBooleanTextNode} from './xsd.js';\nimport GeometryCollection from '../geom/GeometryCollection.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {toRadians} from '../math.js';\nimport {get as getProjection} from '../proj.js';\nimport Fill from '../style/Fill.js';\nimport Icon from '../style/Icon.js';\nimport IconAnchorUnits from '../style/IconAnchorUnits.js';\nimport IconOrigin from '../style/IconOrigin.js';\nimport Stroke from '../style/Stroke.js';\nimport Style from '../style/Style.js';\nimport Text from '../style/Text.js';\nimport {createElementNS, getAllTextContent, isDocument, makeArrayExtender,\n  makeArrayPusher, makeChildAppender, makeObjectPropertySetter,\n  makeReplacer, makeSequence, makeSimpleNodeFactory, makeStructureNS,\n  OBJECT_PROPERTY_NODE_FACTORY, parse, parseNode, pushParseAndPop,\n  pushSerializeAndPop, XML_SCHEMA_INSTANCE_URI} from '../xml.js';\n\n/**\n * @typedef {Object} Vec2\n * @property {number} x\n * @property {IconAnchorUnits} xunits\n * @property {number} y\n * @property {IconAnchorUnits} yunits\n * @property {IconOrigin} origin\n */\n\n/**\n * @typedef {Object} GxTrackObject\n * @property {Array<number>} flatCoordinates\n * @property {Array<number>} whens\n */\n\n\n/**\n * @const\n * @type {Array<string>}\n */\nconst GX_NAMESPACE_URIS = [\n  'http://www.google.com/kml/ext/2.2'\n];\n\n\n/**\n * @const\n * @type {Array<null|string>}\n */\nconst NAMESPACE_URIS = [\n  null,\n  'http://earth.google.com/kml/2.0',\n  'http://earth.google.com/kml/2.1',\n  'http://earth.google.com/kml/2.2',\n  'http://www.opengis.net/kml/2.2'\n];\n\n\n/**\n * @const\n * @type {string}\n */\nconst SCHEMA_LOCATION = 'http://www.opengis.net/kml/2.2 ' +\n    'https://developers.google.com/kml/schema/kml22gx.xsd';\n\n\n/**\n * @type {Object<string, IconAnchorUnits>}\n */\nconst ICON_ANCHOR_UNITS_MAP = {\n  'fraction': IconAnchorUnits.FRACTION,\n  'pixels': IconAnchorUnits.PIXELS,\n  'insetPixels': IconAnchorUnits.PIXELS\n};\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst PLACEMARK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ExtendedData': extendedDataParser,\n    'Region': regionParser,\n    'MultiGeometry': makeObjectPropertySetter(\n      readMultiGeometry, 'geometry'),\n    'LineString': makeObjectPropertySetter(\n      readLineString, 'geometry'),\n    'LinearRing': makeObjectPropertySetter(\n      readLinearRing, 'geometry'),\n    'Point': makeObjectPropertySetter(\n      readPoint, 'geometry'),\n    'Polygon': makeObjectPropertySetter(\n      readPolygon, 'geometry'),\n    'Style': makeObjectPropertySetter(readStyle),\n    'StyleMap': placemarkStyleMapParser,\n    'address': makeObjectPropertySetter(readString),\n    'description': makeObjectPropertySetter(readString),\n    'name': makeObjectPropertySetter(readString),\n    'open': makeObjectPropertySetter(readBoolean),\n    'phoneNumber': makeObjectPropertySetter(readString),\n    'styleUrl': makeObjectPropertySetter(readURI),\n    'visibility': makeObjectPropertySetter(readBoolean)\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'MultiTrack': makeObjectPropertySetter(\n        readGxMultiTrack, 'geometry'),\n      'Track': makeObjectPropertySetter(\n        readGxTrack, 'geometry')\n    }\n  ));\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst NETWORK_LINK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ExtendedData': extendedDataParser,\n    'Region': regionParser,\n    'Link': linkParser,\n    'address': makeObjectPropertySetter(readString),\n    'description': makeObjectPropertySetter(readString),\n    'name': makeObjectPropertySetter(readString),\n    'open': makeObjectPropertySetter(readBoolean),\n    'phoneNumber': makeObjectPropertySetter(readString),\n    'visibility': makeObjectPropertySetter(readBoolean)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst LINK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'href': makeObjectPropertySetter(readURI)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst REGION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LatLonAltBox': latLonAltBoxParser,\n    'Lod': lodParser\n  });\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\nconst KML_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'Document', 'Placemark'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst KML_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Document': makeChildAppender(writeDocument),\n    'Placemark': makeChildAppender(writePlacemark)\n  });\n\n\n/**\n * @type {import(\"../color.js\").Color}\n */\nlet DEFAULT_COLOR;\n\n/**\n * @type {Fill}\n */\nlet DEFAULT_FILL_STYLE = null;\n\n/**\n * Get the default fill style (or null if not yet set).\n * @return {Fill} The default fill style.\n */\nexport function getDefaultFillStyle() {\n  return DEFAULT_FILL_STYLE;\n}\n\n/**\n * @type {import(\"../size.js\").Size}\n */\nlet DEFAULT_IMAGE_STYLE_ANCHOR;\n\n/**\n * @type {IconAnchorUnits}\n */\nlet DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS;\n\n/**\n * @type {IconAnchorUnits}\n */\nlet DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS;\n\n/**\n * @type {import(\"../size.js\").Size}\n */\nlet DEFAULT_IMAGE_STYLE_SIZE;\n\n/**\n * @type {string}\n */\nlet DEFAULT_IMAGE_STYLE_SRC;\n\n/**\n * @type {number}\n */\nlet DEFAULT_IMAGE_SCALE_MULTIPLIER;\n\n/**\n * @type {import(\"../style/Image.js\").default}\n */\nlet DEFAULT_IMAGE_STYLE = null;\n\n/**\n * Get the default image style (or null if not yet set).\n * @return {import(\"../style/Image.js\").default} The default image style.\n */\nexport function getDefaultImageStyle() {\n  return DEFAULT_IMAGE_STYLE;\n}\n\n/**\n * @type {string}\n */\nlet DEFAULT_NO_IMAGE_STYLE;\n\n/**\n * @type {Stroke}\n */\nlet DEFAULT_STROKE_STYLE = null;\n\n/**\n * Get the default stroke style (or null if not yet set).\n * @return {Stroke} The default stroke style.\n */\nexport function getDefaultStrokeStyle() {\n  return DEFAULT_STROKE_STYLE;\n}\n\n/**\n * @type {Stroke}\n */\nlet DEFAULT_TEXT_STROKE_STYLE;\n\n/**\n * @type {Text}\n */\nlet DEFAULT_TEXT_STYLE = null;\n\n/**\n * Get the default text style (or null if not yet set).\n * @return {Text} The default text style.\n */\nexport function getDefaultTextStyle() {\n  return DEFAULT_TEXT_STYLE;\n}\n\n/**\n * @type {Style}\n */\nlet DEFAULT_STYLE = null;\n\n/**\n * Get the default style (or null if not yet set).\n * @return {Style} The default style.\n */\nexport function getDefaultStyle() {\n  return DEFAULT_STYLE;\n}\n\n/**\n * @type {Array<Style>}\n */\nlet DEFAULT_STYLE_ARRAY = null;\n\n/**\n * Get the default style array (or null if not yet set).\n * @return {Array<Style>} The default style.\n */\nexport function getDefaultStyleArray() {\n  return DEFAULT_STYLE_ARRAY;\n}\n\n\nfunction createStyleDefaults() {\n\n  DEFAULT_COLOR = [255, 255, 255, 1];\n\n  DEFAULT_FILL_STYLE = new Fill({\n    color: DEFAULT_COLOR\n  });\n\n  DEFAULT_IMAGE_STYLE_ANCHOR = [20, 2]; // FIXME maybe [8, 32] ?\n\n  DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS = IconAnchorUnits.PIXELS;\n\n  DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS = IconAnchorUnits.PIXELS;\n\n  DEFAULT_IMAGE_STYLE_SIZE = [64, 64];\n\n  DEFAULT_IMAGE_STYLE_SRC =\n      'https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png';\n\n  DEFAULT_IMAGE_SCALE_MULTIPLIER = 0.5;\n\n  DEFAULT_IMAGE_STYLE = new Icon({\n    anchor: DEFAULT_IMAGE_STYLE_ANCHOR,\n    anchorOrigin: IconOrigin.BOTTOM_LEFT,\n    anchorXUnits: DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,\n    anchorYUnits: DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS,\n    crossOrigin: 'anonymous',\n    rotation: 0,\n    scale: DEFAULT_IMAGE_SCALE_MULTIPLIER,\n    size: DEFAULT_IMAGE_STYLE_SIZE,\n    src: DEFAULT_IMAGE_STYLE_SRC\n  });\n\n  DEFAULT_NO_IMAGE_STYLE = 'NO_IMAGE';\n\n  DEFAULT_STROKE_STYLE = new Stroke({\n    color: DEFAULT_COLOR,\n    width: 1\n  });\n\n  DEFAULT_TEXT_STROKE_STYLE = new Stroke({\n    color: [51, 51, 51, 1],\n    width: 2\n  });\n\n  DEFAULT_TEXT_STYLE = new Text({\n    font: 'bold 16px Helvetica',\n    fill: DEFAULT_FILL_STYLE,\n    stroke: DEFAULT_TEXT_STROKE_STYLE,\n    scale: 0.8\n  });\n\n  DEFAULT_STYLE = new Style({\n    fill: DEFAULT_FILL_STYLE,\n    image: DEFAULT_IMAGE_STYLE,\n    text: DEFAULT_TEXT_STYLE,\n    stroke: DEFAULT_STROKE_STYLE,\n    zIndex: 0\n  });\n\n  DEFAULT_STYLE_ARRAY = [DEFAULT_STYLE];\n\n}\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [extractStyles=true] Extract styles from the KML.\n * @property {boolean} [showPointNames=true] Show names as labels for placemarks which contain points.\n * @property {Array<Style>} [defaultStyle] Default style. The\n * default default style is the same as Google Earth.\n * @property {boolean} [writeStyles=true] Write styles into KML.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the KML format.\n *\n * {@link module:ol/format/KML~KML#readFeature} will read the first feature from\n * a KML source.\n *\n * MultiGeometries are converted into GeometryCollections if they are a mix of\n * geometry types, and into MultiPoint/MultiLineString/MultiPolygon if they are\n * all of the same type.\n *\n * Note that the KML format uses the URL() constructor. Older browsers such as IE\n * which do not support this will need a URL polyfill to be loaded before use.\n *\n * @api\n */\nclass KML extends XMLFeature {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    super();\n\n    const options = opt_options ? opt_options : {};\n\n    if (!DEFAULT_STYLE_ARRAY) {\n      createStyleDefaults();\n    }\n\n    /**\n     * @inheritDoc\n     */\n    this.dataProjection = getProjection('EPSG:4326');\n\n    /**\n     * @private\n     * @type {Array<Style>}\n     */\n    this.defaultStyle_ = options.defaultStyle ?\n      options.defaultStyle : DEFAULT_STYLE_ARRAY;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.extractStyles_ = options.extractStyles !== undefined ?\n      options.extractStyles : true;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.writeStyles_ = options.writeStyles !== undefined ?\n      options.writeStyles : true;\n\n    /**\n     * @private\n     * @type {!Object<string, (Array<Style>|string)>}\n     */\n    this.sharedStyles_ = {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.showPointNames_ = options.showPointNames !== undefined ?\n      options.showPointNames : true;\n\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   * @return {Array<Feature>|undefined} Features.\n   */\n  readDocumentOrFolder_(node, objectStack) {\n    // FIXME use scope somehow\n    const parsersNS = makeStructureNS(\n      NAMESPACE_URIS, {\n        'Document': makeArrayExtender(this.readDocumentOrFolder_, this),\n        'Folder': makeArrayExtender(this.readDocumentOrFolder_, this),\n        'Placemark': makeArrayPusher(this.readPlacemark_, this),\n        'Style': this.readSharedStyle_.bind(this),\n        'StyleMap': this.readSharedStyleMap_.bind(this)\n      });\n    /** @type {Array<Feature>} */\n    const features = pushParseAndPop([], parsersNS, node, objectStack, this);\n    if (features) {\n      return features;\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   * @return {Feature|undefined} Feature.\n   */\n  readPlacemark_(node, objectStack) {\n    const object = pushParseAndPop({'geometry': null},\n      PLACEMARK_PARSERS, node, objectStack);\n    if (!object) {\n      return undefined;\n    }\n    const feature = new Feature();\n    const id = node.getAttribute('id');\n    if (id !== null) {\n      feature.setId(id);\n    }\n    const options = /** @type {import(\"./Feature.js\").ReadOptions} */ (objectStack[0]);\n\n    const geometry = object['geometry'];\n    if (geometry) {\n      transformWithOptions(geometry, false, options);\n    }\n    feature.setGeometry(geometry);\n    delete object['geometry'];\n\n    if (this.extractStyles_) {\n      const style = object['Style'];\n      const styleUrl = object['styleUrl'];\n      const styleFunction = createFeatureStyleFunction(\n        style, styleUrl, this.defaultStyle_, this.sharedStyles_,\n        this.showPointNames_);\n      feature.setStyle(styleFunction);\n    }\n    delete object['Style'];\n    // we do not remove the styleUrl property from the object, so it\n    // gets stored on feature when setProperties is called\n\n    feature.setProperties(object);\n\n    return feature;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   */\n  readSharedStyle_(node, objectStack) {\n    const id = node.getAttribute('id');\n    if (id !== null) {\n      const style = readStyle(node, objectStack);\n      if (style) {\n        let styleUri;\n        let baseURI = node.baseURI;\n        if (!baseURI || baseURI == 'about:blank') {\n          baseURI = window.location.href;\n        }\n        if (baseURI) {\n          const url = new URL('#' + id, baseURI);\n          styleUri = url.href;\n        } else {\n          styleUri = '#' + id;\n        }\n        this.sharedStyles_[styleUri] = style;\n      }\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   */\n  readSharedStyleMap_(node, objectStack) {\n    const id = node.getAttribute('id');\n    if (id === null) {\n      return;\n    }\n    const styleMapValue = readStyleMapValue(node, objectStack);\n    if (!styleMapValue) {\n      return;\n    }\n    let styleUri;\n    let baseURI = node.baseURI;\n    if (!baseURI || baseURI == 'about:blank') {\n      baseURI = window.location.href;\n    }\n    if (baseURI) {\n      const url = new URL('#' + id, baseURI);\n      styleUri = url.href;\n    } else {\n      styleUri = '#' + id;\n    }\n    this.sharedStyles_[styleUri] = styleMapValue;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeatureFromNode(node, opt_options) {\n    if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n      return null;\n    }\n    const feature = this.readPlacemark_(\n      node, [this.getReadOptions(node, opt_options)]);\n    if (feature) {\n      return feature;\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeaturesFromNode(node, opt_options) {\n    if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n      return [];\n    }\n    let features;\n    const localName = node.localName;\n    if (localName == 'Document' || localName == 'Folder') {\n      features = this.readDocumentOrFolder_(\n        node, [this.getReadOptions(node, opt_options)]);\n      if (features) {\n        return features;\n      } else {\n        return [];\n      }\n    } else if (localName == 'Placemark') {\n      const feature = this.readPlacemark_(\n        node, [this.getReadOptions(node, opt_options)]);\n      if (feature) {\n        return [feature];\n      } else {\n        return [];\n      }\n    } else if (localName == 'kml') {\n      features = [];\n      for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n        const fs = this.readFeaturesFromNode(n, opt_options);\n        if (fs) {\n          extend(features, fs);\n        }\n      }\n      return features;\n    } else {\n      return [];\n    }\n  }\n\n  /**\n   * Read the name of the KML.\n   *\n   * @param {Document|Element|string} source Source.\n   * @return {string|undefined} Name.\n   * @api\n   */\n  readName(source) {\n    if (!source) {\n      return undefined;\n    } else if (typeof source === 'string') {\n      const doc = parse(source);\n      return this.readNameFromDocument(doc);\n    } else if (isDocument(source)) {\n      return this.readNameFromDocument(/** @type {Document} */ (source));\n    } else {\n      return this.readNameFromNode(/** @type {Element} */ (source));\n    }\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @return {string|undefined} Name.\n   */\n  readNameFromDocument(doc) {\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        const name = this.readNameFromNode(/** @type {Element} */ (n));\n        if (name) {\n          return name;\n        }\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @return {string|undefined} Name.\n   */\n  readNameFromNode(node) {\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          n.localName == 'name') {\n        return readString(n);\n      }\n    }\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      const localName = n.localName;\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          (localName == 'Document' ||\n           localName == 'Folder' ||\n           localName == 'Placemark' ||\n           localName == 'kml')) {\n        const name = this.readNameFromNode(n);\n        if (name) {\n          return name;\n        }\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Read the network links of the KML.\n   *\n   * @param {Document|Element|string} source Source.\n   * @return {Array<Object>} Network links.\n   * @api\n   */\n  readNetworkLinks(source) {\n    const networkLinks = [];\n    if (typeof source === 'string') {\n      const doc = parse(source);\n      extend(networkLinks, this.readNetworkLinksFromDocument(doc));\n    } else if (isDocument(source)) {\n      extend(networkLinks, this.readNetworkLinksFromDocument(\n        /** @type {Document} */ (source)));\n    } else {\n      extend(networkLinks, this.readNetworkLinksFromNode(\n        /** @type {Element} */ (source)));\n    }\n    return networkLinks;\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @return {Array<Object>} Network links.\n   */\n  readNetworkLinksFromDocument(doc) {\n    const networkLinks = [];\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        extend(networkLinks, this.readNetworkLinksFromNode(/** @type {Element} */ (n)));\n      }\n    }\n    return networkLinks;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @return {Array<Object>} Network links.\n   */\n  readNetworkLinksFromNode(node) {\n    const networkLinks = [];\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          n.localName == 'NetworkLink') {\n        const obj = pushParseAndPop({}, NETWORK_LINK_PARSERS,\n          n, []);\n        networkLinks.push(obj);\n      }\n    }\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      const localName = n.localName;\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          (localName == 'Document' ||\n           localName == 'Folder' ||\n           localName == 'kml')) {\n        extend(networkLinks, this.readNetworkLinksFromNode(n));\n      }\n    }\n    return networkLinks;\n  }\n\n  /**\n   * Read the regions of the KML.\n   *\n   * @param {Document|Element|string} source Source.\n   * @return {Array<Object>} Regions.\n   * @api\n   */\n  readRegion(source) {\n    const regions = [];\n    if (typeof source === 'string') {\n      const doc = parse(source);\n      extend(regions, this.readRegionFromDocument(doc));\n    } else if (isDocument(source)) {\n      extend(regions, this.readRegionFromDocument(\n        /** @type {Document} */ (source)));\n    } else {\n      extend(regions, this.readRegionFromNode(\n        /** @type {Element} */ (source)));\n    }\n    return regions;\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @return {Array<Object>} Region.\n   */\n  readRegionFromDocument(doc) {\n    const regions = [];\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        extend(regions, this.readRegionFromNode(/** @type {Element} */ (n)));\n      }\n    }\n    return regions;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @return {Array<Object>} Region.\n   * @api\n   */\n  readRegionFromNode(node) {\n    const regions = [];\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          n.localName == 'Region') {\n        const obj = pushParseAndPop({}, REGION_PARSERS,\n          n, []);\n        regions.push(obj);\n      }\n    }\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      const localName = n.localName;\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          (localName == 'Document' ||\n           localName == 'Folder' ||\n           localName == 'kml')) {\n        extend(regions, this.readRegionFromNode(n));\n      }\n    }\n    return regions;\n  }\n\n  /**\n   * Encode an array of features in the KML format as an XML node. GeometryCollections,\n   * MultiPoints, MultiLineStrings, and MultiPolygons are output as MultiGeometries.\n   *\n   * @param {Array<Feature>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Options.\n   * @return {Node} Node.\n   * @override\n   * @api\n   */\n  writeFeaturesNode(features, opt_options) {\n    opt_options = this.adaptOptions(opt_options);\n    const kml = createElementNS(NAMESPACE_URIS[4], 'kml');\n    const xmlnsUri = 'http://www.w3.org/2000/xmlns/';\n    kml.setAttributeNS(xmlnsUri, 'xmlns:gx', GX_NAMESPACE_URIS[0]);\n    kml.setAttributeNS(xmlnsUri, 'xmlns:xsi', XML_SCHEMA_INSTANCE_URI);\n    kml.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', SCHEMA_LOCATION);\n\n    const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: kml};\n    /** @type {!Object<string, (Array<Feature>|Feature|undefined)>} */\n    const properties = {};\n    if (features.length > 1) {\n      properties['Document'] = features;\n    } else if (features.length == 1) {\n      properties['Placemark'] = features[0];\n    }\n    const orderedKeys = KML_SEQUENCE[kml.namespaceURI];\n    const values = makeSequence(properties, orderedKeys);\n    pushSerializeAndPop(context, KML_SERIALIZERS,\n      OBJECT_PROPERTY_NODE_FACTORY, values, [opt_options], orderedKeys,\n      this);\n    return kml;\n  }\n}\n\n\n/**\n * @param {Style|undefined} foundStyle Style.\n * @param {string} name Name.\n * @return {Style} style Style.\n */\nfunction createNameStyleFunction(foundStyle, name) {\n  let textStyle = null;\n  const textOffset = [0, 0];\n  let textAlign = 'start';\n  if (foundStyle.getImage()) {\n    let imageSize = foundStyle.getImage().getImageSize();\n    if (imageSize === null) {\n      imageSize = DEFAULT_IMAGE_STYLE_SIZE;\n    }\n    if (imageSize.length == 2) {\n      const imageScale = foundStyle.getImage().getScale();\n      // Offset the label to be centered to the right of the icon, if there is\n      // one.\n      textOffset[0] = imageScale * imageSize[0] / 2;\n      textOffset[1] = -imageScale * imageSize[1] / 2;\n      textAlign = 'left';\n    }\n  }\n  if (foundStyle.getText() !== null) {\n    // clone the text style, customizing it with name, alignments and offset.\n    // Note that kml does not support many text options that OpenLayers does (rotation, textBaseline).\n    const foundText = foundStyle.getText();\n    textStyle = foundText.clone();\n    textStyle.setFont(foundText.getFont() || DEFAULT_TEXT_STYLE.getFont());\n    textStyle.setScale(foundText.getScale() || DEFAULT_TEXT_STYLE.getScale());\n    textStyle.setFill(foundText.getFill() || DEFAULT_TEXT_STYLE.getFill());\n    textStyle.setStroke(foundText.getStroke() || DEFAULT_TEXT_STROKE_STYLE);\n  } else {\n    textStyle = DEFAULT_TEXT_STYLE.clone();\n  }\n  textStyle.setText(name);\n  textStyle.setOffsetX(textOffset[0]);\n  textStyle.setOffsetY(textOffset[1]);\n  textStyle.setTextAlign(textAlign);\n\n  const nameStyle = new Style({\n    text: textStyle\n  });\n  return nameStyle;\n}\n\n\n/**\n * @param {Array<Style>|undefined} style Style.\n * @param {string} styleUrl Style URL.\n * @param {Array<Style>} defaultStyle Default style.\n * @param {!Object<string, (Array<Style>|string)>} sharedStyles Shared styles.\n * @param {boolean|undefined} showPointNames true to show names for point placemarks.\n * @return {import(\"../style/Style.js\").StyleFunction} Feature style function.\n */\nfunction createFeatureStyleFunction(style, styleUrl, defaultStyle, sharedStyles, showPointNames) {\n\n  return (\n    /**\n     * @param {Feature} feature feature.\n     * @param {number} resolution Resolution.\n     * @return {Array<Style>} Style.\n     */\n    function(feature, resolution) {\n      let drawName = showPointNames;\n      /** @type {Style|undefined} */\n      let nameStyle;\n      let name = '';\n      if (drawName) {\n        const geometry = feature.getGeometry();\n        if (geometry) {\n          drawName = geometry.getType() === GeometryType.POINT;\n        }\n      }\n\n      if (drawName) {\n        name = /** @type {string} */ (feature.get('name'));\n        drawName = drawName && !!name;\n      }\n\n      if (style) {\n        if (drawName) {\n          nameStyle = createNameStyleFunction(style[0], name);\n          return style.concat(nameStyle);\n        }\n        return style;\n      }\n      if (styleUrl) {\n        const foundStyle = findStyle(styleUrl, defaultStyle, sharedStyles);\n        if (drawName) {\n          nameStyle = createNameStyleFunction(foundStyle[0], name);\n          return foundStyle.concat(nameStyle);\n        }\n        return foundStyle;\n      }\n      if (drawName) {\n        nameStyle = createNameStyleFunction(defaultStyle[0], name);\n        return defaultStyle.concat(nameStyle);\n      }\n      return defaultStyle;\n    }\n  );\n}\n\n\n/**\n * @param {Array<Style>|string|undefined} styleValue Style value.\n * @param {Array<Style>} defaultStyle Default style.\n * @param {!Object<string, (Array<Style>|string)>} sharedStyles\n * Shared styles.\n * @return {Array<Style>} Style.\n */\nfunction findStyle(styleValue, defaultStyle, sharedStyles) {\n  if (Array.isArray(styleValue)) {\n    return styleValue;\n  } else if (typeof styleValue === 'string') {\n    // KML files in the wild occasionally forget the leading `#` on styleUrls\n    // defined in the same document.  Add a leading `#` if it enables to find\n    // a style.\n    if (!(styleValue in sharedStyles) && ('#' + styleValue in sharedStyles)) {\n      styleValue = '#' + styleValue;\n    }\n    return findStyle(sharedStyles[styleValue], defaultStyle, sharedStyles);\n  } else {\n    return defaultStyle;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {import(\"../color.js\").Color|undefined} Color.\n */\nfunction readColor(node) {\n  const s = getAllTextContent(node, false);\n  // The KML specification states that colors should not include a leading `#`\n  // but we tolerate them.\n  const m = /^\\s*#?\\s*([0-9A-Fa-f]{8})\\s*$/.exec(s);\n  if (m) {\n    const hexColor = m[1];\n    return [\n      parseInt(hexColor.substr(6, 2), 16),\n      parseInt(hexColor.substr(4, 2), 16),\n      parseInt(hexColor.substr(2, 2), 16),\n      parseInt(hexColor.substr(0, 2), 16) / 255\n    ];\n\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {Array<number>|undefined} Flat coordinates.\n */\nexport function readFlatCoordinates(node) {\n  let s = getAllTextContent(node, false);\n  const flatCoordinates = [];\n  // The KML specification states that coordinate tuples should not include\n  // spaces, but we tolerate them.\n  const re =\n      /^\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)\\s*,\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)(?:\\s*,\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?))?\\s*/i;\n  let m;\n  while ((m = re.exec(s))) {\n    const x = parseFloat(m[1]);\n    const y = parseFloat(m[2]);\n    const z = m[3] ? parseFloat(m[3]) : 0;\n    flatCoordinates.push(x, y, z);\n    s = s.substr(m[0].length);\n  }\n  if (s !== '') {\n    return undefined;\n  }\n  return flatCoordinates;\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {string} URI.\n */\nfunction readURI(node) {\n  const s = getAllTextContent(node, false).trim();\n  let baseURI = node.baseURI;\n  if (!baseURI || baseURI == 'about:blank') {\n    baseURI = window.location.href;\n  }\n  if (baseURI) {\n    const url = new URL(s, baseURI);\n    return url.href;\n  } else {\n    return s;\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @return {Vec2} Vec2.\n */\nfunction readVec2(node) {\n  const xunits = node.getAttribute('xunits');\n  const yunits = node.getAttribute('yunits');\n  let origin;\n  if (xunits !== 'insetPixels') {\n    if (yunits !== 'insetPixels') {\n      origin = IconOrigin.BOTTOM_LEFT;\n    } else {\n      origin = IconOrigin.TOP_LEFT;\n    }\n  } else {\n    if (yunits !== 'insetPixels') {\n      origin = IconOrigin.BOTTOM_RIGHT;\n    } else {\n      origin = IconOrigin.TOP_RIGHT;\n    }\n  }\n  return {\n    x: parseFloat(node.getAttribute('x')),\n    xunits: ICON_ANCHOR_UNITS_MAP[xunits],\n    y: parseFloat(node.getAttribute('y')),\n    yunits: ICON_ANCHOR_UNITS_MAP[yunits],\n    origin: origin\n  };\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} Scale.\n */\nfunction readScale(node) {\n  return readDecimal(node);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst STYLE_MAP_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Pair': pairDataParser\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Array<Style>|string|undefined} StyleMap.\n */\nfunction readStyleMapValue(node, objectStack) {\n  return pushParseAndPop(undefined,\n    STYLE_MAP_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst ICON_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Icon': makeObjectPropertySetter(readIcon),\n    'heading': makeObjectPropertySetter(readDecimal),\n    'hotSpot': makeObjectPropertySetter(readVec2),\n    'scale': makeObjectPropertySetter(readScale)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction iconStyleParser(node, objectStack) {\n  // FIXME refreshMode\n  // FIXME refreshInterval\n  // FIXME viewRefreshTime\n  // FIXME viewBoundScale\n  // FIXME viewFormat\n  // FIXME httpQuery\n  const object = pushParseAndPop(\n    {}, ICON_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const IconObject = 'Icon' in object ? object['Icon'] : {};\n  const drawIcon = (!('Icon' in object) || Object.keys(IconObject).length > 0);\n  let src;\n  const href = /** @type {string|undefined} */\n      (IconObject['href']);\n  if (href) {\n    src = href;\n  } else if (drawIcon) {\n    src = DEFAULT_IMAGE_STYLE_SRC;\n  }\n  let anchor, anchorXUnits, anchorYUnits;\n  let anchorOrigin = IconOrigin.BOTTOM_LEFT;\n  const hotSpot = /** @type {Vec2|undefined} */\n      (object['hotSpot']);\n  if (hotSpot) {\n    anchor = [hotSpot.x, hotSpot.y];\n    anchorXUnits = hotSpot.xunits;\n    anchorYUnits = hotSpot.yunits;\n    anchorOrigin = hotSpot.origin;\n  } else if (src === DEFAULT_IMAGE_STYLE_SRC) {\n    anchor = DEFAULT_IMAGE_STYLE_ANCHOR;\n    anchorXUnits = DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS;\n    anchorYUnits = DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS;\n  } else if (/^http:\\/\\/maps\\.(?:google|gstatic)\\.com\\//.test(src)) {\n    anchor = [0.5, 0];\n    anchorXUnits = IconAnchorUnits.FRACTION;\n    anchorYUnits = IconAnchorUnits.FRACTION;\n  }\n\n  let offset;\n  const x = /** @type {number|undefined} */\n      (IconObject['x']);\n  const y = /** @type {number|undefined} */\n      (IconObject['y']);\n  if (x !== undefined && y !== undefined) {\n    offset = [x, y];\n  }\n\n  let size;\n  const w = /** @type {number|undefined} */\n      (IconObject['w']);\n  const h = /** @type {number|undefined} */\n      (IconObject['h']);\n  if (w !== undefined && h !== undefined) {\n    size = [w, h];\n  }\n\n  let rotation;\n  const heading = /** @type {number} */\n      (object['heading']);\n  if (heading !== undefined) {\n    rotation = toRadians(heading);\n  }\n\n  let scale = /** @type {number|undefined} */\n      (object['scale']);\n\n  if (drawIcon) {\n    if (src == DEFAULT_IMAGE_STYLE_SRC) {\n      size = DEFAULT_IMAGE_STYLE_SIZE;\n      if (scale === undefined) {\n        scale = DEFAULT_IMAGE_SCALE_MULTIPLIER;\n      }\n    }\n\n    const imageStyle = new Icon({\n      anchor: anchor,\n      anchorOrigin: anchorOrigin,\n      anchorXUnits: anchorXUnits,\n      anchorYUnits: anchorYUnits,\n      crossOrigin: 'anonymous', // FIXME should this be configurable?\n      offset: offset,\n      offsetOrigin: IconOrigin.BOTTOM_LEFT,\n      rotation: rotation,\n      scale: scale,\n      size: size,\n      src: src\n    });\n    styleObject['imageStyle'] = imageStyle;\n  } else {\n    // handle the case when we explicitly want to draw no icon.\n    styleObject['imageStyle'] = DEFAULT_NO_IMAGE_STYLE;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst LABEL_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeObjectPropertySetter(readColor),\n    'scale': makeObjectPropertySetter(readScale)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction labelStyleParser(node, objectStack) {\n  // FIXME colorMode\n  const object = pushParseAndPop(\n    {}, LABEL_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = objectStack[objectStack.length - 1];\n  const textStyle = new Text({\n    fill: new Fill({\n      color: /** @type {import(\"../color.js\").Color} */\n          ('color' in object ? object['color'] : DEFAULT_COLOR)\n    }),\n    scale: /** @type {number|undefined} */\n        (object['scale'])\n  });\n  styleObject['textStyle'] = textStyle;\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst LINE_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeObjectPropertySetter(readColor),\n    'width': makeObjectPropertySetter(readDecimal)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction lineStyleParser(node, objectStack) {\n  // FIXME colorMode\n  // FIXME gx:outerColor\n  // FIXME gx:outerWidth\n  // FIXME gx:physicalWidth\n  // FIXME gx:labelVisibility\n  const object = pushParseAndPop(\n    {}, LINE_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = objectStack[objectStack.length - 1];\n  const strokeStyle = new Stroke({\n    color: /** @type {import(\"../color.js\").Color} */\n        ('color' in object ? object['color'] : DEFAULT_COLOR),\n    width: /** @type {number} */ ('width' in object ? object['width'] : 1)\n  });\n  styleObject['strokeStyle'] = strokeStyle;\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst POLY_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeObjectPropertySetter(readColor),\n    'fill': makeObjectPropertySetter(readBoolean),\n    'outline': makeObjectPropertySetter(readBoolean)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction polyStyleParser(node, objectStack) {\n  // FIXME colorMode\n  const object = pushParseAndPop(\n    {}, POLY_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = objectStack[objectStack.length - 1];\n  const fillStyle = new Fill({\n    color: /** @type {import(\"../color.js\").Color} */\n        ('color' in object ? object['color'] : DEFAULT_COLOR)\n  });\n  styleObject['fillStyle'] = fillStyle;\n  const fill = /** @type {boolean|undefined} */ (object['fill']);\n  if (fill !== undefined) {\n    styleObject['fill'] = fill;\n  }\n  const outline = /** @type {boolean|undefined} */ (object['outline']);\n  if (outline !== undefined) {\n    styleObject['outline'] = outline;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst FLAT_LINEAR_RING_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'coordinates': makeReplacer(readFlatCoordinates)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Array<number>} LinearRing flat coordinates.\n */\nfunction readFlatLinearRing(node, objectStack) {\n  return pushParseAndPop(null,\n    FLAT_LINEAR_RING_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction gxCoordParser(node, objectStack) {\n  const gxTrackObject = /** @type {GxTrackObject} */\n      (objectStack[objectStack.length - 1]);\n  const flatCoordinates = gxTrackObject.flatCoordinates;\n  const s = getAllTextContent(node, false);\n  const re =\n      /^\\s*([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s+([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s+([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s*$/i;\n  const m = re.exec(s);\n  if (m) {\n    const x = parseFloat(m[1]);\n    const y = parseFloat(m[2]);\n    const z = parseFloat(m[3]);\n    flatCoordinates.push(x, y, z, 0);\n  } else {\n    flatCoordinates.push(0, 0, 0, 0);\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst GX_MULTITRACK_GEOMETRY_PARSERS = makeStructureNS(\n  GX_NAMESPACE_URIS, {\n    'Track': makeArrayPusher(readGxTrack)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {MultiLineString|undefined} MultiLineString.\n */\nfunction readGxMultiTrack(node, objectStack) {\n  const lineStrings = pushParseAndPop([],\n    GX_MULTITRACK_GEOMETRY_PARSERS, node, objectStack);\n  if (!lineStrings) {\n    return undefined;\n  }\n  return new MultiLineString(lineStrings);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst GX_TRACK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'when': whenParser\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'coord': gxCoordParser\n    }));\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {LineString|undefined} LineString.\n */\nfunction readGxTrack(node, objectStack) {\n  const gxTrackObject = pushParseAndPop(\n    /** @type {GxTrackObject} */ ({\n      flatCoordinates: [],\n      whens: []\n    }), GX_TRACK_PARSERS, node, objectStack);\n  if (!gxTrackObject) {\n    return undefined;\n  }\n  const flatCoordinates = gxTrackObject.flatCoordinates;\n  const whens = gxTrackObject.whens;\n  for (let i = 0, ii = Math.min(flatCoordinates.length, whens.length); i < ii; ++i) {\n    flatCoordinates[4 * i + 3] = whens[i];\n  }\n  return new LineString(flatCoordinates, GeometryLayout.XYZM);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst ICON_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'href': makeObjectPropertySetter(readURI)\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'x': makeObjectPropertySetter(readDecimal),\n      'y': makeObjectPropertySetter(readDecimal),\n      'w': makeObjectPropertySetter(readDecimal),\n      'h': makeObjectPropertySetter(readDecimal)\n    }));\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object} Icon object.\n */\nfunction readIcon(node, objectStack) {\n  const iconObject = pushParseAndPop(\n    {}, ICON_PARSERS, node, objectStack);\n  if (iconObject) {\n    return iconObject;\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst GEOMETRY_FLAT_COORDINATES_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'coordinates': makeReplacer(readFlatCoordinates)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Array<number>} Flat coordinates.\n */\nfunction readFlatCoordinatesFromNode(node, objectStack) {\n  return pushParseAndPop(null,\n    GEOMETRY_FLAT_COORDINATES_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst EXTRUDE_AND_ALTITUDE_MODE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'extrude': makeObjectPropertySetter(readBoolean),\n    'tessellate': makeObjectPropertySetter(readBoolean),\n    'altitudeMode': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {LineString|undefined} LineString.\n */\nfunction readLineString(node, objectStack) {\n  const properties = pushParseAndPop({},\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatCoordinates =\n      readFlatCoordinatesFromNode(node, objectStack);\n  if (flatCoordinates) {\n    const lineString = new LineString(flatCoordinates, GeometryLayout.XYZ);\n    lineString.setProperties(properties);\n    return lineString;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Polygon|undefined} Polygon.\n */\nfunction readLinearRing(node, objectStack) {\n  const properties = pushParseAndPop({},\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatCoordinates =\n      readFlatCoordinatesFromNode(node, objectStack);\n  if (flatCoordinates) {\n    const polygon = new Polygon(flatCoordinates, GeometryLayout.XYZ, [flatCoordinates.length]);\n    polygon.setProperties(properties);\n    return polygon;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst MULTI_GEOMETRY_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LineString': makeArrayPusher(readLineString),\n    'LinearRing': makeArrayPusher(readLinearRing),\n    'MultiGeometry': makeArrayPusher(readMultiGeometry),\n    'Point': makeArrayPusher(readPoint),\n    'Polygon': makeArrayPusher(readPolygon)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {import(\"../geom/Geometry.js\").default} Geometry.\n */\nfunction readMultiGeometry(node, objectStack) {\n  const geometries = pushParseAndPop([],\n    MULTI_GEOMETRY_PARSERS, node, objectStack);\n  if (!geometries) {\n    return null;\n  }\n  if (geometries.length === 0) {\n    return new GeometryCollection(geometries);\n  }\n  let multiGeometry;\n  let homogeneous = true;\n  const type = geometries[0].getType();\n  let geometry;\n  for (let i = 1, ii = geometries.length; i < ii; ++i) {\n    geometry = geometries[i];\n    if (geometry.getType() != type) {\n      homogeneous = false;\n      break;\n    }\n  }\n  if (homogeneous) {\n    let layout;\n    let flatCoordinates;\n    if (type == GeometryType.POINT) {\n      const point = geometries[0];\n      layout = point.getLayout();\n      flatCoordinates = point.getFlatCoordinates();\n      for (let i = 1, ii = geometries.length; i < ii; ++i) {\n        geometry = geometries[i];\n        extend(flatCoordinates, geometry.getFlatCoordinates());\n      }\n      multiGeometry = new MultiPoint(flatCoordinates, layout);\n      setCommonGeometryProperties(multiGeometry, geometries);\n    } else if (type == GeometryType.LINE_STRING) {\n      multiGeometry = new MultiLineString(geometries);\n      setCommonGeometryProperties(multiGeometry, geometries);\n    } else if (type == GeometryType.POLYGON) {\n      multiGeometry = new MultiPolygon(geometries);\n      setCommonGeometryProperties(multiGeometry, geometries);\n    } else if (type == GeometryType.GEOMETRY_COLLECTION) {\n      multiGeometry = new GeometryCollection(geometries);\n    } else {\n      assert(false, 37); // Unknown geometry type found\n    }\n  } else {\n    multiGeometry = new GeometryCollection(geometries);\n  }\n  return (\n    /** @type {import(\"../geom/Geometry.js\").default} */ (multiGeometry)\n  );\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Point|undefined} Point.\n */\nfunction readPoint(node, objectStack) {\n  const properties = pushParseAndPop({},\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatCoordinates =\n      readFlatCoordinatesFromNode(node, objectStack);\n  if (flatCoordinates) {\n    const point = new Point(flatCoordinates, GeometryLayout.XYZ);\n    point.setProperties(properties);\n    return point;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst FLAT_LINEAR_RINGS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'innerBoundaryIs': innerBoundaryIsParser,\n    'outerBoundaryIs': outerBoundaryIsParser\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Polygon|undefined} Polygon.\n */\nfunction readPolygon(node, objectStack) {\n  const properties = pushParseAndPop(/** @type {Object<string,*>} */ ({}),\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatLinearRings = pushParseAndPop([null],\n    FLAT_LINEAR_RINGS_PARSERS, node, objectStack);\n  if (flatLinearRings && flatLinearRings[0]) {\n    const flatCoordinates = flatLinearRings[0];\n    const ends = [flatCoordinates.length];\n    for (let i = 1, ii = flatLinearRings.length; i < ii; ++i) {\n      extend(flatCoordinates, flatLinearRings[i]);\n      ends.push(flatCoordinates.length);\n    }\n    const polygon = new Polygon(flatCoordinates, GeometryLayout.XYZ, ends);\n    polygon.setProperties(properties);\n    return polygon;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'IconStyle': iconStyleParser,\n    'LabelStyle': labelStyleParser,\n    'LineStyle': lineStyleParser,\n    'PolyStyle': polyStyleParser\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Array<Style>} Style.\n */\nfunction readStyle(node, objectStack) {\n  const styleObject = pushParseAndPop(\n    {}, STYLE_PARSERS, node, objectStack);\n  if (!styleObject) {\n    return null;\n  }\n  let fillStyle = /** @type {Fill} */\n      ('fillStyle' in styleObject ?\n        styleObject['fillStyle'] : DEFAULT_FILL_STYLE);\n  const fill = /** @type {boolean|undefined} */ (styleObject['fill']);\n  if (fill !== undefined && !fill) {\n    fillStyle = null;\n  }\n  let imageStyle;\n  if ('imageStyle' in styleObject) {\n    if (styleObject['imageStyle'] != DEFAULT_NO_IMAGE_STYLE) {\n      imageStyle = styleObject['imageStyle'];\n    }\n  } else {\n    imageStyle = DEFAULT_IMAGE_STYLE;\n  }\n  const textStyle = /** @type {Text} */\n      ('textStyle' in styleObject ?\n        styleObject['textStyle'] : DEFAULT_TEXT_STYLE);\n  let strokeStyle = /** @type {Stroke} */\n      ('strokeStyle' in styleObject ?\n        styleObject['strokeStyle'] : DEFAULT_STROKE_STYLE);\n  const outline = /** @type {boolean|undefined} */\n      (styleObject['outline']);\n  if (outline !== undefined && !outline) {\n    strokeStyle = null;\n  }\n  return [new Style({\n    fill: fillStyle,\n    image: imageStyle,\n    stroke: strokeStyle,\n    text: textStyle,\n    zIndex: undefined // FIXME\n  })];\n}\n\n\n/**\n * Reads an array of geometries and creates arrays for common geometry\n * properties. Then sets them to the multi geometry.\n * @param {MultiPoint|MultiLineString|MultiPolygon} multiGeometry A multi-geometry.\n * @param {Array<import(\"../geom/Geometry.js\").default>} geometries List of geometries.\n */\nfunction setCommonGeometryProperties(multiGeometry, geometries) {\n  const ii = geometries.length;\n  const extrudes = new Array(geometries.length);\n  const tessellates = new Array(geometries.length);\n  const altitudeModes = new Array(geometries.length);\n  let hasExtrude, hasTessellate, hasAltitudeMode;\n  hasExtrude = hasTessellate = hasAltitudeMode = false;\n  for (let i = 0; i < ii; ++i) {\n    const geometry = geometries[i];\n    extrudes[i] = geometry.get('extrude');\n    tessellates[i] = geometry.get('tessellate');\n    altitudeModes[i] = geometry.get('altitudeMode');\n    hasExtrude = hasExtrude || extrudes[i] !== undefined;\n    hasTessellate = hasTessellate || tessellates[i] !== undefined;\n    hasAltitudeMode = hasAltitudeMode || altitudeModes[i];\n  }\n  if (hasExtrude) {\n    multiGeometry.set('extrude', extrudes);\n  }\n  if (hasTessellate) {\n    multiGeometry.set('tessellate', tessellates);\n  }\n  if (hasAltitudeMode) {\n    multiGeometry.set('altitudeMode', altitudeModes);\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst DATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'displayName': makeObjectPropertySetter(readString),\n    'value': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction dataParser(node, objectStack) {\n  const name = node.getAttribute('name');\n  parseNode(DATA_PARSERS, node, objectStack);\n  const featureObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  if (name !== null) {\n    featureObject[name] = featureObject.value;\n  } else if (featureObject.displayName !== null) {\n    featureObject[featureObject.displayName] = featureObject.value;\n  }\n  delete featureObject['value'];\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst EXTENDED_DATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Data': dataParser,\n    'SchemaData': schemaDataParser\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction extendedDataParser(node, objectStack) {\n  parseNode(EXTENDED_DATA_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction regionParser(node, objectStack) {\n  parseNode(REGION_PARSERS, node, objectStack);\n}\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst PAIR_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Style': makeObjectPropertySetter(readStyle),\n    'key': makeObjectPropertySetter(readString),\n    'styleUrl': makeObjectPropertySetter(readURI)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction pairDataParser(node, objectStack) {\n  const pairObject = pushParseAndPop(\n    {}, PAIR_PARSERS, node, objectStack);\n  if (!pairObject) {\n    return;\n  }\n  const key = /** @type {string|undefined} */\n      (pairObject['key']);\n  if (key && key == 'normal') {\n    const styleUrl = /** @type {string|undefined} */\n        (pairObject['styleUrl']);\n    if (styleUrl) {\n      objectStack[objectStack.length - 1] = styleUrl;\n    }\n    const style = /** @type {Style} */\n        (pairObject['Style']);\n    if (style) {\n      objectStack[objectStack.length - 1] = style;\n    }\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction placemarkStyleMapParser(node, objectStack) {\n  const styleMapValue = readStyleMapValue(node, objectStack);\n  if (!styleMapValue) {\n    return;\n  }\n  const placemarkObject = objectStack[objectStack.length - 1];\n  if (Array.isArray(styleMapValue)) {\n    placemarkObject['Style'] = styleMapValue;\n  } else if (typeof styleMapValue === 'string') {\n    placemarkObject['styleUrl'] = styleMapValue;\n  } else {\n    assert(false, 38); // `styleMapValue` has an unknown type\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst SCHEMA_DATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'SimpleData': simpleDataParser\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction schemaDataParser(node, objectStack) {\n  parseNode(SCHEMA_DATA_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction simpleDataParser(node, objectStack) {\n  const name = node.getAttribute('name');\n  if (name !== null) {\n    const data = readString(node);\n    const featureObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n    featureObject[name] = data;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst LAT_LON_ALT_BOX_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'altitudeMode': makeObjectPropertySetter(readString),\n    'minAltitude': makeObjectPropertySetter(readDecimal),\n    'maxAltitude': makeObjectPropertySetter(readDecimal),\n    'north': makeObjectPropertySetter(readDecimal),\n    'south': makeObjectPropertySetter(readDecimal),\n    'east': makeObjectPropertySetter(readDecimal),\n    'west': makeObjectPropertySetter(readDecimal)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction latLonAltBoxParser(node, objectStack) {\n  const object = pushParseAndPop({}, LAT_LON_ALT_BOX_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const regionObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const extent = [\n    parseFloat(object['west']),\n    parseFloat(object['south']),\n    parseFloat(object['east']),\n    parseFloat(object['north'])\n  ];\n  regionObject['extent'] = extent;\n  regionObject['altitudeMode'] = object['altitudeMode'];\n  regionObject['minAltitude'] = parseFloat(object['minAltitude']);\n  regionObject['maxAltitude'] = parseFloat(object['maxAltitude']);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst LOD_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'minLodPixels': makeObjectPropertySetter(readDecimal),\n    'maxLodPixels': makeObjectPropertySetter(readDecimal),\n    'minFadeExtent': makeObjectPropertySetter(readDecimal),\n    'maxFadeExtent': makeObjectPropertySetter(readDecimal)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction lodParser(node, objectStack) {\n  const object = pushParseAndPop({}, LOD_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const lodObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  lodObject['minLodPixels'] = parseFloat(object['minLodPixels']);\n  lodObject['maxLodPixels'] = parseFloat(object['maxLodPixels']);\n  lodObject['minFadeExtent'] = parseFloat(object['minFadeExtent']);\n  lodObject['maxFadeExtent'] = parseFloat(object['maxFadeExtent']);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst INNER_BOUNDARY_IS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LinearRing': makeReplacer(readFlatLinearRing)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction innerBoundaryIsParser(node, objectStack) {\n  /** @type {Array<number>|undefined} */\n  const flatLinearRing = pushParseAndPop(undefined,\n    INNER_BOUNDARY_IS_PARSERS, node, objectStack);\n  if (flatLinearRing) {\n    const flatLinearRings = /** @type {Array<Array<number>>} */\n        (objectStack[objectStack.length - 1]);\n    flatLinearRings.push(flatLinearRing);\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst OUTER_BOUNDARY_IS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LinearRing': makeReplacer(readFlatLinearRing)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction outerBoundaryIsParser(node, objectStack) {\n  /** @type {Array<number>|undefined} */\n  const flatLinearRing = pushParseAndPop(undefined,\n    OUTER_BOUNDARY_IS_PARSERS, node, objectStack);\n  if (flatLinearRing) {\n    const flatLinearRings = /** @type {Array<Array<number>>} */\n        (objectStack[objectStack.length - 1]);\n    flatLinearRings[0] = flatLinearRing;\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction linkParser(node, objectStack) {\n  parseNode(LINK_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction whenParser(node, objectStack) {\n  const gxTrackObject = /** @type {GxTrackObject} */\n      (objectStack[objectStack.length - 1]);\n  const whens = gxTrackObject.whens;\n  const s = getAllTextContent(node, false);\n  const when = Date.parse(s);\n  whens.push(isNaN(when) ? 0 : when);\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the color to.\n * @param {import(\"../color.js\").Color|string} color Color.\n */\nfunction writeColorTextNode(node, color) {\n  const rgba = asArray(color);\n  const opacity = (rgba.length == 4) ? rgba[3] : 1;\n  /** @type {Array<string|number>} */\n  const abgr = [opacity * 255, rgba[2], rgba[1], rgba[0]];\n  for (let i = 0; i < 4; ++i) {\n    const hex = Math.floor(/** @type {number} */ (abgr[i])).toString(16);\n    abgr[i] = (hex.length == 1) ? '0' + hex : hex;\n  }\n  writeStringTextNode(node, abgr.join(''));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the coordinates to.\n * @param {Array<number>} coordinates Coordinates.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeCoordinatesTextNode(node, coordinates, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n\n  const layout = context['layout'];\n  const stride = context['stride'];\n\n  let dimension;\n  if (layout == GeometryLayout.XY ||\n      layout == GeometryLayout.XYM) {\n    dimension = 2;\n  } else if (layout == GeometryLayout.XYZ ||\n      layout == GeometryLayout.XYZM) {\n    dimension = 3;\n  } else {\n    assert(false, 34); // Invalid geometry layout\n  }\n\n  const ii = coordinates.length;\n  let text = '';\n  if (ii > 0) {\n    text += coordinates[0];\n    for (let d = 1; d < dimension; ++d) {\n      text += ',' + coordinates[d];\n    }\n    for (let i = stride; i < ii; i += stride) {\n      text += ' ' + coordinates[i];\n      for (let d = 1; d < dimension; ++d) {\n        text += ',' + coordinates[i + d];\n      }\n    }\n  }\n  writeStringTextNode(node, text);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst EXTENDEDDATA_NODE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Data': makeChildAppender(writeDataNode),\n    'value': makeChildAppender(writeDataNodeValue),\n    'displayName': makeChildAppender(writeDataNodeName)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {{name: *, value: *}} pair Name value pair.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeDataNode(node, pair, objectStack) {\n  node.setAttribute('name', pair.name);\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const value = pair.value;\n\n  if (typeof value == 'object') {\n    if (value !== null && value.displayName) {\n      pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n        OBJECT_PROPERTY_NODE_FACTORY, [value.displayName], objectStack, ['displayName']);\n    }\n\n    if (value !== null && value.value) {\n      pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n        OBJECT_PROPERTY_NODE_FACTORY, [value.value], objectStack, ['value']);\n    }\n  } else {\n    pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n      OBJECT_PROPERTY_NODE_FACTORY, [value], objectStack, ['value']);\n  }\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the name to.\n * @param {string} name DisplayName.\n */\nfunction writeDataNodeName(node, name) {\n  writeCDATASection(node, name);\n}\n\n\n/**\n * @param {Node} node Node to append a CDATA Section with the value to.\n * @param {string} value Value.\n */\nfunction writeDataNodeValue(node, value) {\n  writeStringTextNode(node, value);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst DOCUMENT_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Placemark': makeChildAppender(writePlacemark)\n  });\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nconst DOCUMENT_NODE_FACTORY = function(value, objectStack, opt_nodeName) {\n  const parentNode = objectStack[objectStack.length - 1].node;\n  return createElementNS(parentNode.namespaceURI, 'Placemark');\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<Feature>} features Features.\n * @param {Array<*>} objectStack Object stack.\n * @this {KML}\n */\nfunction writeDocument(node, features, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  pushSerializeAndPop(context, DOCUMENT_SERIALIZERS,\n    DOCUMENT_NODE_FACTORY, features, objectStack, undefined,\n    this);\n}\n\n\n/**\n * A factory for creating Data nodes.\n * @const\n * @type {function(*, Array<*>): (Node|undefined)}\n */\nconst DATA_NODE_FACTORY = makeSimpleNodeFactory('Data');\n\n\n/**\n * @param {Node} node Node.\n * @param {{names: Array<string>, values: (Array<*>)}} namesAndValues Names and values.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeExtendedData(node, namesAndValues, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const names = namesAndValues.names;\n  const values = namesAndValues.values;\n  const length = names.length;\n\n  for (let i = 0; i < length; i++) {\n    pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n      DATA_NODE_FACTORY, [{name: names[i], value: values[i]}], objectStack);\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\nconst ICON_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'href'\n  ],\n  makeStructureNS(GX_NAMESPACE_URIS, [\n    'x', 'y', 'w', 'h'\n  ]));\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst ICON_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'href': makeChildAppender(writeStringTextNode)\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'x': makeChildAppender(writeDecimalTextNode),\n      'y': makeChildAppender(writeDecimalTextNode),\n      'w': makeChildAppender(writeDecimalTextNode),\n      'h': makeChildAppender(writeDecimalTextNode)\n    }));\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nconst GX_NODE_FACTORY = function(value, objectStack, opt_nodeName) {\n  return createElementNS(GX_NAMESPACE_URIS[0],\n    'gx:' + opt_nodeName);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Object} icon Icon object.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeIcon(node, icon, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const parentNode = objectStack[objectStack.length - 1].node;\n  let orderedKeys = ICON_SEQUENCE[parentNode.namespaceURI];\n  let values = makeSequence(icon, orderedKeys);\n  pushSerializeAndPop(context,\n    ICON_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    values, objectStack, orderedKeys);\n  orderedKeys =\n      ICON_SEQUENCE[GX_NAMESPACE_URIS[0]];\n  values = makeSequence(icon, orderedKeys);\n  pushSerializeAndPop(context, ICON_SERIALIZERS,\n    GX_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\nconst ICON_STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'scale', 'heading', 'Icon', 'hotSpot'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst ICON_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Icon': makeChildAppender(writeIcon),\n    'heading': makeChildAppender(writeDecimalTextNode),\n    'hotSpot': makeChildAppender(writeVec2),\n    'scale': makeChildAppender(writeScaleTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"../style/Icon.js\").default} style Icon style.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeIconStyle(node, style, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const properties = {};\n  const src = style.getSrc();\n  const size = style.getSize();\n  const iconImageSize = style.getImageSize();\n  const iconProperties = {\n    'href': src\n  };\n\n  if (size) {\n    iconProperties['w'] = size[0];\n    iconProperties['h'] = size[1];\n    const anchor = style.getAnchor(); // top-left\n    const origin = style.getOrigin(); // top-left\n\n    if (origin && iconImageSize && origin[0] !== 0 && origin[1] !== size[1]) {\n      iconProperties['x'] = origin[0];\n      iconProperties['y'] = iconImageSize[1] - (origin[1] + size[1]);\n    }\n\n    if (anchor && (anchor[0] !== size[0] / 2 || anchor[1] !== size[1] / 2)) {\n      const /** @type {Vec2} */ hotSpot = {\n        x: anchor[0],\n        xunits: IconAnchorUnits.PIXELS,\n        y: size[1] - anchor[1],\n        yunits: IconAnchorUnits.PIXELS\n      };\n      properties['hotSpot'] = hotSpot;\n    }\n  }\n\n  properties['Icon'] = iconProperties;\n\n  const scale = style.getScale();\n  if (scale !== 1) {\n    properties['scale'] = scale;\n  }\n\n  const rotation = style.getRotation();\n  if (rotation !== 0) {\n    properties['heading'] = rotation; // 0-360\n  }\n\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = ICON_STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, ICON_STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\nconst LABEL_STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'color', 'scale'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst LABEL_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeChildAppender(writeColorTextNode),\n    'scale': makeChildAppender(writeScaleTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Text} style style.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeLabelStyle(node, style, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const properties = {};\n  const fill = style.getFill();\n  if (fill) {\n    properties['color'] = fill.getColor();\n  }\n  const scale = style.getScale();\n  if (scale && scale !== 1) {\n    properties['scale'] = scale;\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys =\n      LABEL_STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, LABEL_STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\nconst LINE_STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'color', 'width'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst LINE_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeChildAppender(writeColorTextNode),\n    'width': makeChildAppender(writeDecimalTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Stroke} style style.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeLineStyle(node, style, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const properties = {\n    'color': style.getColor(),\n    'width': style.getWidth()\n  };\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = LINE_STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, LINE_STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object<string, string>}\n */\nconst GEOMETRY_TYPE_TO_NODENAME = {\n  'Point': 'Point',\n  'LineString': 'LineString',\n  'LinearRing': 'LinearRing',\n  'Polygon': 'Polygon',\n  'MultiPoint': 'MultiGeometry',\n  'MultiLineString': 'MultiGeometry',\n  'MultiPolygon': 'MultiGeometry',\n  'GeometryCollection': 'MultiGeometry'\n};\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nconst GEOMETRY_NODE_FACTORY = function(value, objectStack, opt_nodeName) {\n  if (value) {\n    const parentNode = objectStack[objectStack.length - 1].node;\n    return createElementNS(parentNode.namespaceURI,\n      GEOMETRY_TYPE_TO_NODENAME[/** @type {import(\"../geom/Geometry.js\").default} */ (value).getType()]);\n  }\n};\n\n\n/**\n * A factory for creating Point nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst POINT_NODE_FACTORY = makeSimpleNodeFactory('Point');\n\n\n/**\n * A factory for creating LineString nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst LINE_STRING_NODE_FACTORY = makeSimpleNodeFactory('LineString');\n\n\n/**\n * A factory for creating LinearRing nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst LINEAR_RING_NODE_FACTORY = makeSimpleNodeFactory('LinearRing');\n\n\n/**\n * A factory for creating Polygon nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst POLYGON_NODE_FACTORY = makeSimpleNodeFactory('Polygon');\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst MULTI_GEOMETRY_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LineString': makeChildAppender(\n      writePrimitiveGeometry),\n    'Point': makeChildAppender(\n      writePrimitiveGeometry),\n    'Polygon': makeChildAppender(writePolygon),\n    'GeometryCollection': makeChildAppender(\n      writeMultiGeometry)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeMultiGeometry(node, geometry, objectStack) {\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n  const context = {node: node};\n  const type = geometry.getType();\n  /** @type {Array<import(\"../geom/Geometry.js\").default>} */\n  let geometries;\n  /** @type {function(*, Array<*>, string=): (Node|undefined)} */\n  let factory;\n  if (type == GeometryType.GEOMETRY_COLLECTION) {\n    geometries = /** @type {GeometryCollection} */ (geometry).getGeometries();\n    factory = GEOMETRY_NODE_FACTORY;\n  } else if (type == GeometryType.MULTI_POINT) {\n    geometries = /** @type {MultiPoint} */ (geometry).getPoints();\n    factory = POINT_NODE_FACTORY;\n  } else if (type == GeometryType.MULTI_LINE_STRING) {\n    geometries =\n        (/** @type {MultiLineString} */ (geometry)).getLineStrings();\n    factory = LINE_STRING_NODE_FACTORY;\n  } else if (type == GeometryType.MULTI_POLYGON) {\n    geometries =\n        (/** @type {MultiPolygon} */ (geometry)).getPolygons();\n    factory = POLYGON_NODE_FACTORY;\n  } else {\n    assert(false, 39); // Unknown geometry type\n  }\n  pushSerializeAndPop(context,\n    MULTI_GEOMETRY_SERIALIZERS, factory,\n    geometries, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst BOUNDARY_IS_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LinearRing': makeChildAppender(\n      writePrimitiveGeometry)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"../geom/LinearRing.js\").default} linearRing Linear ring.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeBoundaryIs(node, linearRing, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  pushSerializeAndPop(context,\n    BOUNDARY_IS_SERIALIZERS,\n    LINEAR_RING_NODE_FACTORY, [linearRing], objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst PLACEMARK_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ExtendedData': makeChildAppender(writeExtendedData),\n    'MultiGeometry': makeChildAppender(writeMultiGeometry),\n    'LineString': makeChildAppender(writePrimitiveGeometry),\n    'LinearRing': makeChildAppender(writePrimitiveGeometry),\n    'Point': makeChildAppender(writePrimitiveGeometry),\n    'Polygon': makeChildAppender(writePolygon),\n    'Style': makeChildAppender(writeStyle),\n    'address': makeChildAppender(writeStringTextNode),\n    'description': makeChildAppender(writeStringTextNode),\n    'name': makeChildAppender(writeStringTextNode),\n    'open': makeChildAppender(writeBooleanTextNode),\n    'phoneNumber': makeChildAppender(writeStringTextNode),\n    'styleUrl': makeChildAppender(writeStringTextNode),\n    'visibility': makeChildAppender(writeBooleanTextNode)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\nconst PLACEMARK_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'name', 'open', 'visibility', 'address', 'phoneNumber', 'description',\n    'styleUrl', 'Style'\n  ]);\n\n\n/**\n * A factory for creating ExtendedData nodes.\n * @const\n * @type {function(*, Array<*>): (Node|undefined)}\n */\nconst EXTENDEDDATA_NODE_FACTORY = makeSimpleNodeFactory('ExtendedData');\n\n\n/**\n * FIXME currently we do serialize arbitrary/custom feature properties\n * (ExtendedData).\n * @param {Element} node Node.\n * @param {Feature} feature Feature.\n * @param {Array<*>} objectStack Object stack.\n * @this {KML}\n */\nfunction writePlacemark(node, feature, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n\n  // set id\n  if (feature.getId()) {\n    node.setAttribute('id', /** @type {string} */ (feature.getId()));\n  }\n\n  // serialize properties (properties unknown to KML are not serialized)\n  const properties = feature.getProperties();\n\n  // don't export these to ExtendedData\n  const filter = {'address': 1, 'description': 1, 'name': 1, 'open': 1,\n    'phoneNumber': 1, 'styleUrl': 1, 'visibility': 1};\n  filter[feature.getGeometryName()] = 1;\n  const keys = Object.keys(properties || {}).sort().filter(function(v) {\n    return !filter[v];\n  });\n\n  if (keys.length > 0) {\n    const sequence = makeSequence(properties, keys);\n    const namesAndValues = {names: keys, values: sequence};\n    pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\n      EXTENDEDDATA_NODE_FACTORY, [namesAndValues], objectStack);\n  }\n\n  const styleFunction = feature.getStyleFunction();\n  if (styleFunction) {\n    // FIXME the styles returned by the style function are supposed to be\n    // resolution-independent here\n    const styles = styleFunction(feature, 0);\n    if (styles) {\n      const style = Array.isArray(styles) ? styles[0] : styles;\n      if (this.writeStyles_) {\n        properties['Style'] = style;\n      }\n      const textStyle = style.getText();\n      if (textStyle) {\n        properties['name'] = textStyle.getText();\n      }\n    }\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = PLACEMARK_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n\n  // serialize geometry\n  const options = /** @type {import(\"./Feature.js\").WriteOptions} */ (objectStack[0]);\n  let geometry = feature.getGeometry();\n  if (geometry) {\n    geometry = /** @type {import(\"../geom/Geometry.js\").default} */ (transformWithOptions(geometry, true, options));\n  }\n  pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\n    GEOMETRY_NODE_FACTORY, [geometry], objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\nconst PRIMITIVE_GEOMETRY_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'extrude', 'tessellate', 'altitudeMode', 'coordinates'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst PRIMITIVE_GEOMETRY_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'extrude': makeChildAppender(writeBooleanTextNode),\n    'tessellate': makeChildAppender(writeBooleanTextNode),\n    'altitudeMode': makeChildAppender(writeStringTextNode),\n    'coordinates': makeChildAppender(writeCoordinatesTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"../geom/SimpleGeometry.js\").default} geometry Geometry.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writePrimitiveGeometry(node, geometry, objectStack) {\n  const flatCoordinates = geometry.getFlatCoordinates();\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  context['layout'] = geometry.getLayout();\n  context['stride'] = geometry.getStride();\n\n  // serialize properties (properties unknown to KML are not serialized)\n  const properties = geometry.getProperties();\n  properties.coordinates = flatCoordinates;\n\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = PRIMITIVE_GEOMETRY_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, PRIMITIVE_GEOMETRY_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst POLYGON_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'outerBoundaryIs': makeChildAppender(\n      writeBoundaryIs),\n    'innerBoundaryIs': makeChildAppender(\n      writeBoundaryIs)\n  });\n\n\n/**\n * A factory for creating innerBoundaryIs nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst INNER_BOUNDARY_NODE_FACTORY = makeSimpleNodeFactory('innerBoundaryIs');\n\n\n/**\n * A factory for creating outerBoundaryIs nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst OUTER_BOUNDARY_NODE_FACTORY = makeSimpleNodeFactory('outerBoundaryIs');\n\n\n/**\n * @param {Node} node Node.\n * @param {Polygon} polygon Polygon.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writePolygon(node, polygon, objectStack) {\n  const linearRings = polygon.getLinearRings();\n  const outerRing = linearRings.shift();\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  // inner rings\n  pushSerializeAndPop(context,\n    POLYGON_SERIALIZERS,\n    INNER_BOUNDARY_NODE_FACTORY,\n    linearRings, objectStack);\n  // outer ring\n  pushSerializeAndPop(context,\n    POLYGON_SERIALIZERS,\n    OUTER_BOUNDARY_NODE_FACTORY,\n    [outerRing], objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst POLY_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeChildAppender(writeColorTextNode)\n  });\n\n\n/**\n * A factory for creating coordinates nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst COLOR_NODE_FACTORY = makeSimpleNodeFactory('color');\n\n\n/**\n * @param {Node} node Node.\n * @param {Fill} style Style.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writePolyStyle(node, style, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  pushSerializeAndPop(context, POLY_STYLE_SERIALIZERS,\n    COLOR_NODE_FACTORY, [style.getColor()], objectStack);\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the scale to.\n * @param {number|undefined} scale Scale.\n */\nfunction writeScaleTextNode(node, scale) {\n  // the Math is to remove any excess decimals created by float arithmetic\n  writeDecimalTextNode(node,\n    Math.round(scale * 1e6) / 1e6);\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\nconst STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'IconStyle', 'LabelStyle', 'LineStyle', 'PolyStyle'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'IconStyle': makeChildAppender(writeIconStyle),\n    'LabelStyle': makeChildAppender(writeLabelStyle),\n    'LineStyle': makeChildAppender(writeLineStyle),\n    'PolyStyle': makeChildAppender(writePolyStyle)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Style} style Style.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeStyle(node, style, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const properties = {};\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  const imageStyle = style.getImage();\n  const textStyle = style.getText();\n  if (imageStyle && typeof /** @type {?} */ (imageStyle).getSrc === 'function') {\n    properties['IconStyle'] = imageStyle;\n  }\n  if (textStyle) {\n    properties['LabelStyle'] = textStyle;\n  }\n  if (strokeStyle) {\n    properties['LineStyle'] = strokeStyle;\n  }\n  if (fillStyle) {\n    properties['PolyStyle'] = fillStyle;\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @param {Element} node Node to append a TextNode with the Vec2 to.\n * @param {Vec2} vec2 Vec2.\n */\nfunction writeVec2(node, vec2) {\n  node.setAttribute('x', String(vec2.x));\n  node.setAttribute('y', String(vec2.y));\n  node.setAttribute('xunits', vec2.xunits);\n  node.setAttribute('yunits', vec2.yunits);\n}\n\n\nexport default KML;\n"],"names":["const","let","super","n","i","ii","d"],"mappings":"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"}