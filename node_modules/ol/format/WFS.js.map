{"version":3,"file":"WFS.js","sources":["../../../src/ol/format/WFS.js"],"sourcesContent":["/**\n * @module ol/format/WFS\n */\nimport {assert} from '../asserts.js';\nimport GML2 from './GML2.js';\nimport GML3 from './GML3.js';\nimport GMLBase, {GMLNS} from './GMLBase.js';\nimport {and as andFilter, bbox as bboxFilter} from './filter.js';\nimport XMLFeature from './XMLFeature.js';\nimport {readNonNegativeIntegerString, readNonNegativeInteger, writeStringTextNode} from './xsd.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\nimport {createElementNS, isDocument, makeArrayPusher, makeChildAppender,\n  makeObjectPropertySetter, makeSimpleNodeFactory, parse, parseNode,\n  pushParseAndPop, pushSerializeAndPop, XML_SCHEMA_INSTANCE_URI} from '../xml.js';\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst FEATURE_COLLECTION_PARSERS = {\n  'http://www.opengis.net/gml': {\n    'boundedBy': makeObjectPropertySetter(\n      GMLBase.prototype.readGeometryElement, 'bounds')\n  }\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst TRANSACTION_SUMMARY_PARSERS = {\n  'http://www.opengis.net/wfs': {\n    'totalInserted': makeObjectPropertySetter(readNonNegativeInteger),\n    'totalUpdated': makeObjectPropertySetter(readNonNegativeInteger),\n    'totalDeleted': makeObjectPropertySetter(readNonNegativeInteger)\n  }\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst TRANSACTION_RESPONSE_PARSERS = {\n  'http://www.opengis.net/wfs': {\n    'TransactionSummary': makeObjectPropertySetter(\n      readTransactionSummary, 'transactionSummary'),\n    'InsertResults': makeObjectPropertySetter(\n      readInsertResults, 'insertIds')\n  }\n};\n\n\n/**\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst QUERY_SERIALIZERS = {\n  'http://www.opengis.net/wfs': {\n    'PropertyName': makeChildAppender(writeStringTextNode)\n  }\n};\n\n\n/**\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst TRANSACTION_SERIALIZERS = {\n  'http://www.opengis.net/wfs': {\n    'Insert': makeChildAppender(writeFeature),\n    'Update': makeChildAppender(writeUpdate),\n    'Delete': makeChildAppender(writeDelete),\n    'Property': makeChildAppender(writeProperty),\n    'Native': makeChildAppender(writeNative)\n  }\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {Object<string, string>|string} [featureNS] The namespace URI used for features.\n * @property {Array<string>|string} [featureType] The feature type to parse. Only used for read operations.\n * @property {GMLBase} [gmlFormat] The GML format to use to parse the response. Default is `ol/format/GML3`.\n * @property {string} [schemaLocation] Optional schemaLocation to use for serialization, this will override the default.\n */\n\n\n/**\n * @typedef {Object} WriteGetFeatureOptions\n * @property {string} featureNS The namespace URI used for features.\n * @property {string} featurePrefix The prefix for the feature namespace.\n * @property {Array<string>} featureTypes The feature type names.\n * @property {string} [srsName] SRS name. No srsName attribute will be set on\n * geometries when this is not provided.\n * @property {string} [handle] Handle.\n * @property {string} [outputFormat] Output format.\n * @property {number} [maxFeatures] Maximum number of features to fetch.\n * @property {string} [geometryName] Geometry name to use in a BBOX filter.\n * @property {Array<string>} [propertyNames] Optional list of property names to serialize.\n * @property {string} [viewParams] viewParams GeoServer vendor parameter.\n * @property {number} [startIndex] Start index to use for WFS paging. This is a\n * WFS 2.0 feature backported to WFS 1.1.0 by some Web Feature Services.\n * @property {number} [count] Number of features to retrieve when paging. This is a\n * WFS 2.0 feature backported to WFS 1.1.0 by some Web Feature Services. Please note that some\n * Web Feature Services have repurposed `maxfeatures` instead.\n * @property {import(\"../extent.js\").Extent} [bbox] Extent to use for the BBOX filter.\n * @property {import(\"./filter/Filter.js\").default} [filter] Filter condition. See\n * {@link module:ol/format/Filter} for more information.\n * @property {string} [resultType] Indicates what response should be returned,\n * E.g. `hits` only includes the `numberOfFeatures` attribute in the response and no features.\n */\n\n\n/**\n * @typedef {Object} WriteTransactionOptions\n * @property {string} featureNS The namespace URI used for features.\n * @property {string} featurePrefix The prefix for the feature namespace.\n * @property {string} featureType The feature type name.\n * @property {string} [srsName] SRS name. No srsName attribute will be set on\n * geometries when this is not provided.\n * @property {string} [handle] Handle.\n * @property {boolean} [hasZ] Must be set to true if the transaction is for\n * a 3D layer. This will allow the Z coordinate to be included in the transaction.\n * @property {Array<Object>} nativeElements Native elements. Currently not supported.\n * @property {import(\"./GMLBase.js\").Options} [gmlOptions] GML options for the WFS transaction writer.\n * @property {string} [version='1.1.0'] WFS version to use for the transaction. Can be either `1.0.0` or `1.1.0`.\n */\n\n\n/**\n * Number of features; bounds/extent.\n * @typedef {Object} FeatureCollectionMetadata\n * @property {number} numberOfFeatures\n * @property {import(\"../extent.js\").Extent} bounds\n */\n\n\n/**\n * Total deleted; total inserted; total updated; array of insert ids.\n * @typedef {Object} TransactionResponse\n * @property {number} totalDeleted\n * @property {number} totalInserted\n * @property {number} totalUpdated\n * @property {Array<string>} insertIds\n */\n\n\n/**\n * @type {string}\n */\nconst FEATURE_PREFIX = 'feature';\n\n\n/**\n * @type {string}\n */\nconst XMLNS = 'http://www.w3.org/2000/xmlns/';\n\n\n/**\n * @type {string}\n */\nconst OGCNS = 'http://www.opengis.net/ogc';\n\n\n/**\n * @type {string}\n */\nconst WFSNS = 'http://www.opengis.net/wfs';\n\n\n/**\n * @type {string}\n */\nconst FESNS = 'http://www.opengis.net/fes';\n\n\n/**\n * @type {Object<string, string>}\n */\nconst SCHEMA_LOCATIONS = {\n  '1.1.0': 'http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd',\n  '1.0.0': 'http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd'\n};\n\n\n/**\n * @const\n * @type {string}\n */\nconst DEFAULT_VERSION = '1.1.0';\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the WFS format.\n * By default, supports WFS version 1.1.0. You can pass a GML format\n * as option if you want to read a WFS that contains GML2 (WFS 1.0.0).\n * Also see {@link module:ol/format/GMLBase~GMLBase} which is used by this format.\n *\n * @api\n */\nclass WFS extends XMLFeature {\n\n  /**\n   * @param {Options=} opt_options Optional configuration object.\n   */\n  constructor(opt_options) {\n    super();\n\n    const options = opt_options ? opt_options : {};\n\n    /**\n     * @private\n     * @type {Array<string>|string|undefined}\n     */\n    this.featureType_ = options.featureType;\n\n    /**\n     * @private\n     * @type {Object<string, string>|string|undefined}\n     */\n    this.featureNS_ = options.featureNS;\n\n    /**\n     * @private\n     * @type {GMLBase}\n     */\n    this.gmlFormat_ = options.gmlFormat ?\n      options.gmlFormat : new GML3();\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.schemaLocation_ = options.schemaLocation ?\n      options.schemaLocation : SCHEMA_LOCATIONS[DEFAULT_VERSION];\n  }\n\n  /**\n   * @return {Array<string>|string|undefined} featureType\n   */\n  getFeatureType() {\n    return this.featureType_;\n  }\n\n  /**\n   * @param {Array<string>|string|undefined} featureType Feature type(s) to parse.\n   */\n  setFeatureType(featureType) {\n    this.featureType_ = featureType;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeaturesFromNode(node, opt_options) {\n    /** @type {import(\"../xml.js\").NodeStackItem} */\n    const context = {\n      node: node\n    };\n    assign(context, {\n      'featureType': this.featureType_,\n      'featureNS': this.featureNS_\n    });\n\n    assign(context, this.getReadOptions(node, opt_options ? opt_options : {}));\n    const objectStack = [context];\n    this.gmlFormat_.FEATURE_COLLECTION_PARSERS[GMLNS][\n      'featureMember'] =\n        makeArrayPusher(GMLBase.prototype.readFeaturesInternal);\n    let features = pushParseAndPop([],\n      this.gmlFormat_.FEATURE_COLLECTION_PARSERS, node,\n      objectStack, this.gmlFormat_);\n    if (!features) {\n      features = [];\n    }\n    return features;\n  }\n\n  /**\n   * Read transaction response of the source.\n   *\n   * @param {Document|Element|Object|string} source Source.\n   * @return {TransactionResponse|undefined} Transaction response.\n   * @api\n   */\n  readTransactionResponse(source) {\n    if (!source) {\n      return undefined;\n    } else if (typeof source === 'string') {\n      const doc = parse(source);\n      return this.readTransactionResponseFromDocument(doc);\n    } else if (isDocument(source)) {\n      return this.readTransactionResponseFromDocument(\n        /** @type {Document} */ (source));\n    } else {\n      return this.readTransactionResponseFromNode(/** @type {Element} */ (source));\n    }\n  }\n\n  /**\n   * Read feature collection metadata of the source.\n   *\n   * @param {Document|Element|Object|string} source Source.\n   * @return {FeatureCollectionMetadata|undefined}\n   *     FeatureCollection metadata.\n   * @api\n   */\n  readFeatureCollectionMetadata(source) {\n    if (!source) {\n      return undefined;\n    } else if (typeof source === 'string') {\n      const doc = parse(source);\n      return this.readFeatureCollectionMetadataFromDocument(doc);\n    } else if (isDocument(source)) {\n      return this.readFeatureCollectionMetadataFromDocument(\n        /** @type {Document} */ (source));\n    } else {\n      return this.readFeatureCollectionMetadataFromNode(\n        /** @type {Element} */ (source));\n    }\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @return {FeatureCollectionMetadata|undefined}\n   *     FeatureCollection metadata.\n   */\n  readFeatureCollectionMetadataFromDocument(doc) {\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        return this.readFeatureCollectionMetadataFromNode(/** @type {Element} */ (n));\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @return {FeatureCollectionMetadata|undefined}\n   *     FeatureCollection metadata.\n   */\n  readFeatureCollectionMetadataFromNode(node) {\n    const result = {};\n    const value = readNonNegativeIntegerString(\n      node.getAttribute('numberOfFeatures'));\n    result['numberOfFeatures'] = value;\n    return pushParseAndPop(\n      /** @type {FeatureCollectionMetadata} */ (result),\n      FEATURE_COLLECTION_PARSERS, node, [], this.gmlFormat_);\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @return {TransactionResponse|undefined} Transaction response.\n   */\n  readTransactionResponseFromDocument(doc) {\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        return this.readTransactionResponseFromNode(/** @type {Element} */ (n));\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @return {TransactionResponse|undefined} Transaction response.\n   */\n  readTransactionResponseFromNode(node) {\n    return pushParseAndPop(\n      /** @type {TransactionResponse} */({}),\n      TRANSACTION_RESPONSE_PARSERS, node, []);\n  }\n\n  /**\n   * Encode format as WFS `GetFeature` and return the Node.\n   *\n   * @param {WriteGetFeatureOptions} options Options.\n   * @return {Node} Result.\n   * @api\n   */\n  writeGetFeature(options) {\n    const node = createElementNS(WFSNS, 'GetFeature');\n    node.setAttribute('service', 'WFS');\n    node.setAttribute('version', '1.1.0');\n    let filter;\n    if (options) {\n      if (options.handle) {\n        node.setAttribute('handle', options.handle);\n      }\n      if (options.outputFormat) {\n        node.setAttribute('outputFormat', options.outputFormat);\n      }\n      if (options.maxFeatures !== undefined) {\n        node.setAttribute('maxFeatures', String(options.maxFeatures));\n      }\n      if (options.resultType) {\n        node.setAttribute('resultType', options.resultType);\n      }\n      if (options.startIndex !== undefined) {\n        node.setAttribute('startIndex', String(options.startIndex));\n      }\n      if (options.count !== undefined) {\n        node.setAttribute('count', String(options.count));\n      }\n      if (options.viewParams !== undefined) {\n        node.setAttribute('viewParams ', options.viewParams);\n      }\n      filter = options.filter;\n      if (options.bbox) {\n        assert(options.geometryName,\n          12); // `options.geometryName` must also be provided when `options.bbox` is set\n        const bbox = bboxFilter(\n          /** @type {string} */ (options.geometryName), options.bbox, options.srsName);\n        if (filter) {\n          // if bbox and filter are both set, combine the two into a single filter\n          filter = andFilter(filter, bbox);\n        } else {\n          filter = bbox;\n        }\n      }\n    }\n    node.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', this.schemaLocation_);\n    /** @type {import(\"../xml.js\").NodeStackItem} */\n    const context = {\n      node: node\n    };\n    assign(context, {\n      'srsName': options.srsName,\n      'featureNS': options.featureNS ? options.featureNS : this.featureNS_,\n      'featurePrefix': options.featurePrefix,\n      'geometryName': options.geometryName,\n      'filter': filter,\n      'propertyNames': options.propertyNames ? options.propertyNames : []\n    });\n\n    assert(Array.isArray(options.featureTypes),\n      11); // `options.featureTypes` should be an Array\n    writeGetFeature(node, /** @type {!Array<string>} */ (options.featureTypes), [context]);\n    return node;\n  }\n\n  /**\n   * Encode format as WFS `Transaction` and return the Node.\n   *\n   * @param {Array<import(\"../Feature.js\").default>} inserts The features to insert.\n   * @param {Array<import(\"../Feature.js\").default>} updates The features to update.\n   * @param {Array<import(\"../Feature.js\").default>} deletes The features to delete.\n   * @param {WriteTransactionOptions} options Write options.\n   * @return {Node} Result.\n   * @api\n   */\n  writeTransaction(inserts, updates, deletes, options) {\n    const objectStack = [];\n    const node = createElementNS(WFSNS, 'Transaction');\n    const version = options.version ? options.version : DEFAULT_VERSION;\n    const gmlVersion = version === '1.0.0' ? 2 : 3;\n    node.setAttribute('service', 'WFS');\n    node.setAttribute('version', version);\n    let baseObj;\n    /** @type {import(\"../xml.js\").NodeStackItem} */\n    let obj;\n    if (options) {\n      baseObj = options.gmlOptions ? options.gmlOptions : {};\n      if (options.handle) {\n        node.setAttribute('handle', options.handle);\n      }\n    }\n    const schemaLocation = SCHEMA_LOCATIONS[version];\n    node.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', schemaLocation);\n    const featurePrefix = options.featurePrefix ? options.featurePrefix : FEATURE_PREFIX;\n    if (inserts) {\n      obj = assign({node: node}, {'featureNS': options.featureNS,\n        'featureType': options.featureType, 'featurePrefix': featurePrefix,\n        'gmlVersion': gmlVersion, 'hasZ': options.hasZ, 'srsName': options.srsName});\n      assign(obj, baseObj);\n      pushSerializeAndPop(obj,\n        TRANSACTION_SERIALIZERS,\n        makeSimpleNodeFactory('Insert'), inserts,\n        objectStack);\n    }\n    if (updates) {\n      obj = assign({node: node}, {'featureNS': options.featureNS,\n        'featureType': options.featureType, 'featurePrefix': featurePrefix,\n        'gmlVersion': gmlVersion, 'hasZ': options.hasZ, 'srsName': options.srsName});\n      assign(obj, baseObj);\n      pushSerializeAndPop(obj,\n        TRANSACTION_SERIALIZERS,\n        makeSimpleNodeFactory('Update'), updates,\n        objectStack);\n    }\n    if (deletes) {\n      pushSerializeAndPop({node: node, 'featureNS': options.featureNS,\n        'featureType': options.featureType, 'featurePrefix': featurePrefix,\n        'gmlVersion': gmlVersion, 'srsName': options.srsName},\n      TRANSACTION_SERIALIZERS,\n      makeSimpleNodeFactory('Delete'), deletes,\n      objectStack);\n    }\n    if (options.nativeElements) {\n      pushSerializeAndPop({node: node, 'featureNS': options.featureNS,\n        'featureType': options.featureType, 'featurePrefix': featurePrefix,\n        'gmlVersion': gmlVersion, 'srsName': options.srsName},\n      TRANSACTION_SERIALIZERS,\n      makeSimpleNodeFactory('Native'), options.nativeElements,\n      objectStack);\n    }\n    return node;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readProjectionFromDocument(doc) {\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        return this.readProjectionFromNode(n);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readProjectionFromNode(node) {\n    if (node.firstElementChild &&\n        node.firstElementChild.firstElementChild) {\n      node = node.firstElementChild.firstElementChild;\n      for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n        if (!(n.childNodes.length === 0 ||\n            (n.childNodes.length === 1 &&\n            n.firstChild.nodeType === 3))) {\n          const objectStack = [{}];\n          this.gmlFormat_.readGeometryElement(n, objectStack);\n          return getProjection(objectStack.pop().srsName);\n        }\n      }\n    }\n\n    return null;\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Transaction Summary.\n */\nfunction readTransactionSummary(node, objectStack) {\n  return pushParseAndPop(\n    {}, TRANSACTION_SUMMARY_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst OGC_FID_PARSERS = {\n  'http://www.opengis.net/ogc': {\n    'FeatureId': makeArrayPusher(function(node, objectStack) {\n      return node.getAttribute('fid');\n    })\n  }\n};\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction fidParser(node, objectStack) {\n  parseNode(OGC_FID_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst INSERT_RESULTS_PARSERS = {\n  'http://www.opengis.net/wfs': {\n    'Feature': fidParser\n  }\n};\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Array<string>|undefined} Insert results.\n */\nfunction readInsertResults(node, objectStack) {\n  return pushParseAndPop(\n    [], INSERT_RESULTS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {import(\"../Feature.js\").default} feature Feature.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeFeature(node, feature, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const featureType = context['featureType'];\n  const featureNS = context['featureNS'];\n  const gmlVersion = context['gmlVersion'];\n  const child = createElementNS(featureNS, featureType);\n  node.appendChild(child);\n  if (gmlVersion === 2) {\n    GML2.prototype.writeFeatureElement(child, feature, objectStack);\n  } else {\n    GML3.prototype.writeFeatureElement(child, feature, objectStack);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {number|string} fid Feature identifier.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeOgcFidFilter(node, fid, objectStack) {\n  const filter = createElementNS(OGCNS, 'Filter');\n  const child = createElementNS(OGCNS, 'FeatureId');\n  filter.appendChild(child);\n  child.setAttribute('fid', /** @type {string} */ (fid));\n  node.appendChild(filter);\n}\n\n\n/**\n * @param {string|undefined} featurePrefix The prefix of the feature.\n * @param {string} featureType The type of the feature.\n * @returns {string} The value of the typeName property.\n */\nfunction getTypeName(featurePrefix, featureType) {\n  featurePrefix = featurePrefix ? featurePrefix : FEATURE_PREFIX;\n  const prefix = featurePrefix + ':';\n  // The featureType already contains the prefix.\n  if (featureType.indexOf(prefix) === 0) {\n    return featureType;\n  } else {\n    return prefix + featureType;\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {import(\"../Feature.js\").default} feature Feature.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeDelete(node, feature, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  assert(feature.getId() !== undefined, 26); // Features must have an id set\n  const featureType = context['featureType'];\n  const featurePrefix = context['featurePrefix'];\n  const featureNS = context['featureNS'];\n  const typeName = getTypeName(featurePrefix, featureType);\n  node.setAttribute('typeName', typeName);\n  node.setAttributeNS(XMLNS, 'xmlns:' + featurePrefix, featureNS);\n  const fid = feature.getId();\n  if (fid !== undefined) {\n    writeOgcFidFilter(node, fid, objectStack);\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {import(\"../Feature.js\").default} feature Feature.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeUpdate(node, feature, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  assert(feature.getId() !== undefined, 27); // Features must have an id set\n  const featureType = context['featureType'];\n  const featurePrefix = context['featurePrefix'];\n  const featureNS = context['featureNS'];\n  const typeName = getTypeName(featurePrefix, featureType);\n  const geometryName = feature.getGeometryName();\n  node.setAttribute('typeName', typeName);\n  node.setAttributeNS(XMLNS, 'xmlns:' + featurePrefix, featureNS);\n  const fid = feature.getId();\n  if (fid !== undefined) {\n    const keys = feature.getKeys();\n    const values = [];\n    for (let i = 0, ii = keys.length; i < ii; i++) {\n      const value = feature.get(keys[i]);\n      if (value !== undefined) {\n        let name = keys[i];\n        if (value && typeof /** @type {?} */ (value).getSimplifiedGeometry === 'function') {\n          name = geometryName;\n        }\n        values.push({name: name, value: value});\n      }\n    }\n    pushSerializeAndPop(/** @type {import(\"../xml.js\").NodeStackItem} */ (\n      {'gmlVersion': context['gmlVersion'], node: node,\n        'hasZ': context['hasZ'], 'srsName': context['srsName']}),\n    TRANSACTION_SERIALIZERS,\n    makeSimpleNodeFactory('Property'), values,\n    objectStack);\n    writeOgcFidFilter(node, fid, objectStack);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Object} pair Property name and value.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeProperty(node, pair, objectStack) {\n  const name = createElementNS(WFSNS, 'Name');\n  const context = objectStack[objectStack.length - 1];\n  const gmlVersion = context['gmlVersion'];\n  node.appendChild(name);\n  writeStringTextNode(name, pair.name);\n  if (pair.value !== undefined && pair.value !== null) {\n    const value = createElementNS(WFSNS, 'Value');\n    node.appendChild(value);\n    if (pair.value && typeof /** @type {?} */ (pair.value).getSimplifiedGeometry === 'function') {\n      if (gmlVersion === 2) {\n        GML2.prototype.writeGeometryElement(value,\n          pair.value, objectStack);\n      } else {\n        GML3.prototype.writeGeometryElement(value,\n          pair.value, objectStack);\n      }\n    } else {\n      writeStringTextNode(value, pair.value);\n    }\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {{vendorId: string, safeToIgnore: boolean, value: string}} nativeElement The native element.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeNative(node, nativeElement, objectStack) {\n  if (nativeElement.vendorId) {\n    node.setAttribute('vendorId', nativeElement.vendorId);\n  }\n  if (nativeElement.safeToIgnore !== undefined) {\n    node.setAttribute('safeToIgnore', String(nativeElement.safeToIgnore));\n  }\n  if (nativeElement.value !== undefined) {\n    writeStringTextNode(node, nativeElement.value);\n  }\n}\n\n\n/**\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\nconst GETFEATURE_SERIALIZERS = {\n  'http://www.opengis.net/wfs': {\n    'Query': makeChildAppender(writeQuery)\n  },\n  'http://www.opengis.net/ogc': {\n    'During': makeChildAppender(writeDuringFilter),\n    'And': makeChildAppender(writeLogicalFilter),\n    'Or': makeChildAppender(writeLogicalFilter),\n    'Not': makeChildAppender(writeNotFilter),\n    'BBOX': makeChildAppender(writeBboxFilter),\n    'Contains': makeChildAppender(writeContainsFilter),\n    'Intersects': makeChildAppender(writeIntersectsFilter),\n    'Within': makeChildAppender(writeWithinFilter),\n    'PropertyIsEqualTo': makeChildAppender(writeComparisonFilter),\n    'PropertyIsNotEqualTo': makeChildAppender(writeComparisonFilter),\n    'PropertyIsLessThan': makeChildAppender(writeComparisonFilter),\n    'PropertyIsLessThanOrEqualTo': makeChildAppender(writeComparisonFilter),\n    'PropertyIsGreaterThan': makeChildAppender(writeComparisonFilter),\n    'PropertyIsGreaterThanOrEqualTo': makeChildAppender(writeComparisonFilter),\n    'PropertyIsNull': makeChildAppender(writeIsNullFilter),\n    'PropertyIsBetween': makeChildAppender(writeIsBetweenFilter),\n    'PropertyIsLike': makeChildAppender(writeIsLikeFilter)\n  }\n};\n\n\n/**\n * @param {Element} node Node.\n * @param {string} featureType Feature type.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeQuery(node, featureType, objectStack) {\n  const context = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const featurePrefix = context['featurePrefix'];\n  const featureNS = context['featureNS'];\n  const propertyNames = context['propertyNames'];\n  const srsName = context['srsName'];\n  let typeName;\n  // If feature prefix is not defined, we must not use the default prefix.\n  if (featurePrefix) {\n    typeName = getTypeName(featurePrefix, featureType);\n  } else {\n    typeName = featureType;\n  }\n  node.setAttribute('typeName', typeName);\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  if (featureNS) {\n    node.setAttributeNS(XMLNS, 'xmlns:' + featurePrefix, featureNS);\n  }\n  const item = /** @type {import(\"../xml.js\").NodeStackItem} */ (assign({}, context));\n  item.node = node;\n  pushSerializeAndPop(item,\n    QUERY_SERIALIZERS,\n    makeSimpleNodeFactory('PropertyName'), propertyNames,\n    objectStack);\n  const filter = context['filter'];\n  if (filter) {\n    const child = createElementNS(OGCNS, 'Filter');\n    node.appendChild(child);\n    writeFilterCondition(child, filter, objectStack);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"./filter/Filter.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeFilterCondition(node, filter, objectStack) {\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n  const item = {node: node};\n  pushSerializeAndPop(item,\n    GETFEATURE_SERIALIZERS,\n    makeSimpleNodeFactory(filter.getTagName()),\n    [filter], objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"./filter/Bbox.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeBboxFilter(node, filter, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  context['srsName'] = filter.srsName;\n\n  writeOgcPropertyName(node, filter.geometryName);\n  GML3.prototype.writeGeometryElement(node, filter.extent, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"./filter/Contains.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeContainsFilter(node, filter, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  context['srsName'] = filter.srsName;\n\n  writeOgcPropertyName(node, filter.geometryName);\n  GML3.prototype.writeGeometryElement(node, filter.geometry, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"./filter/Intersects.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeIntersectsFilter(node, filter, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  context['srsName'] = filter.srsName;\n\n  writeOgcPropertyName(node, filter.geometryName);\n  GML3.prototype.writeGeometryElement(node, filter.geometry, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"./filter/Within.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeWithinFilter(node, filter, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  context['srsName'] = filter.srsName;\n\n  writeOgcPropertyName(node, filter.geometryName);\n  GML3.prototype.writeGeometryElement(node, filter.geometry, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"./filter/During.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeDuringFilter(node, filter, objectStack) {\n\n  const valueReference = createElementNS(FESNS, 'ValueReference');\n  writeStringTextNode(valueReference, filter.propertyName);\n  node.appendChild(valueReference);\n\n  const timePeriod = createElementNS(GMLNS, 'TimePeriod');\n\n  node.appendChild(timePeriod);\n\n  const begin = createElementNS(GMLNS, 'begin');\n  timePeriod.appendChild(begin);\n  writeTimeInstant(begin, filter.begin);\n\n  const end = createElementNS(GMLNS, 'end');\n  timePeriod.appendChild(end);\n  writeTimeInstant(end, filter.end);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"./filter/LogicalNary.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeLogicalFilter(node, filter, objectStack) {\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n  const item = {node: node};\n  const conditions = filter.conditions;\n  for (let i = 0, ii = conditions.length; i < ii; ++i) {\n    const condition = conditions[i];\n    pushSerializeAndPop(item,\n      GETFEATURE_SERIALIZERS,\n      makeSimpleNodeFactory(condition.getTagName()),\n      [condition], objectStack);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"./filter/Not.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeNotFilter(node, filter, objectStack) {\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n  const item = {node: node};\n  const condition = filter.condition;\n  pushSerializeAndPop(item,\n    GETFEATURE_SERIALIZERS,\n    makeSimpleNodeFactory(condition.getTagName()),\n    [condition], objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {import(\"./filter/ComparisonBinary.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeComparisonFilter(node, filter, objectStack) {\n  if (filter.matchCase !== undefined) {\n    node.setAttribute('matchCase', filter.matchCase.toString());\n  }\n  writeOgcPropertyName(node, filter.propertyName);\n  writeOgcLiteral(node, '' + filter.expression);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"./filter/IsNull.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeIsNullFilter(node, filter, objectStack) {\n  writeOgcPropertyName(node, filter.propertyName);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"./filter/IsBetween.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeIsBetweenFilter(node, filter, objectStack) {\n  writeOgcPropertyName(node, filter.propertyName);\n\n  const lowerBoundary = createElementNS(OGCNS, 'LowerBoundary');\n  node.appendChild(lowerBoundary);\n  writeOgcLiteral(lowerBoundary, '' + filter.lowerBoundary);\n\n  const upperBoundary = createElementNS(OGCNS, 'UpperBoundary');\n  node.appendChild(upperBoundary);\n  writeOgcLiteral(upperBoundary, '' + filter.upperBoundary);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {import(\"./filter/IsLike.js\").default} filter Filter.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeIsLikeFilter(node, filter, objectStack) {\n  node.setAttribute('wildCard', filter.wildCard);\n  node.setAttribute('singleChar', filter.singleChar);\n  node.setAttribute('escapeChar', filter.escapeChar);\n  if (filter.matchCase !== undefined) {\n    node.setAttribute('matchCase', filter.matchCase.toString());\n  }\n  writeOgcPropertyName(node, filter.propertyName);\n  writeOgcLiteral(node, '' + filter.pattern);\n}\n\n\n/**\n * @param {string} tagName Tag name.\n * @param {Node} node Node.\n * @param {string} value Value.\n */\nfunction writeOgcExpression(tagName, node, value) {\n  const property = createElementNS(OGCNS, tagName);\n  writeStringTextNode(property, value);\n  node.appendChild(property);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {string} value PropertyName value.\n */\nfunction writeOgcPropertyName(node, value) {\n  writeOgcExpression('PropertyName', node, value);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {string} value PropertyName value.\n */\nfunction writeOgcLiteral(node, value) {\n  writeOgcExpression('Literal', node, value);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {string} time PropertyName value.\n */\nfunction writeTimeInstant(node, time) {\n  const timeInstant = createElementNS(GMLNS, 'TimeInstant');\n  node.appendChild(timeInstant);\n\n  const timePosition = createElementNS(GMLNS, 'timePosition');\n  timeInstant.appendChild(timePosition);\n  writeStringTextNode(timePosition, time);\n}\n\n\n/**\n * Encode filter as WFS `Filter` and return the Node.\n *\n * @param {import(\"./filter/Filter.js\").default} filter Filter.\n * @return {Node} Result.\n * @api\n */\nexport function writeFilter(filter) {\n  const child = createElementNS(OGCNS, 'Filter');\n  writeFilterCondition(child, filter, []);\n  return child;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<string>} featureTypes Feature types.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeGetFeature(node, featureTypes, objectStack) {\n  const context = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const item = /** @type {import(\"../xml.js\").NodeStackItem} */ (assign({}, context));\n  item.node = node;\n  pushSerializeAndPop(item,\n    GETFEATURE_SERIALIZERS,\n    makeSimpleNodeFactory('Query'), featureTypes,\n    objectStack);\n}\n\n\nexport default WFS;\n"],"names":["const","super","let"],"mappings":"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"}