{"version":3,"file":"OWS.js","sources":["../../../src/ol/format/OWS.js"],"sourcesContent":["/**\n * @module ol/format/OWS\n */\nimport {readHref} from './XLink.js';\nimport XML from './XML.js';\nimport {readString} from './xsd.js';\nimport {makeObjectPropertyPusher, makeObjectPropertySetter, makeStructureNS, pushParseAndPop} from '../xml.js';\n\n\n/**\n * @const\n * @type {Array<null|string>}\n */\nconst NAMESPACE_URIS = [null, 'http://www.opengis.net/ows/1.1'];\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ServiceIdentification': makeObjectPropertySetter(readServiceIdentification),\n    'ServiceProvider': makeObjectPropertySetter(readServiceProvider),\n    'OperationsMetadata': makeObjectPropertySetter(readOperationsMetadata)\n  });\n\n\nclass OWS extends XML {\n  constructor() {\n    super();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFromDocument(doc) {\n    for (let n = doc.firstChild; n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        return this.readFromNode(n);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFromNode(node) {\n    const owsObject = pushParseAndPop({},\n      PARSERS, node, []);\n    return owsObject ? owsObject : null;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst ADDRESS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'DeliveryPoint': makeObjectPropertySetter(readString),\n    'City': makeObjectPropertySetter(readString),\n    'AdministrativeArea': makeObjectPropertySetter(readString),\n    'PostalCode': makeObjectPropertySetter(readString),\n    'Country': makeObjectPropertySetter(readString),\n    'ElectronicMailAddress': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst ALLOWED_VALUES_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Value': makeObjectPropertyPusher(readValue)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst CONSTRAINT_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'AllowedValues': makeObjectPropertySetter(readAllowedValues)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst CONTACT_INFO_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Phone': makeObjectPropertySetter(readPhone),\n    'Address': makeObjectPropertySetter(readAddress)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst DCP_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'HTTP': makeObjectPropertySetter(readHttp)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst HTTP_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Get': makeObjectPropertyPusher(readGet),\n    'Post': undefined // TODO\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst OPERATION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'DCP': makeObjectPropertySetter(readDcp)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst OPERATIONS_METADATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Operation': readOperation\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst PHONE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Voice': makeObjectPropertySetter(readString),\n    'Facsimile': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst REQUEST_METHOD_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Constraint': makeObjectPropertyPusher(readConstraint)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst SERVICE_CONTACT_PARSERS =\n    makeStructureNS(\n      NAMESPACE_URIS, {\n        'IndividualName': makeObjectPropertySetter(readString),\n        'PositionName': makeObjectPropertySetter(readString),\n        'ContactInfo': makeObjectPropertySetter(readContactInfo)\n      });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst SERVICE_IDENTIFICATION_PARSERS =\n    makeStructureNS(\n      NAMESPACE_URIS, {\n        'Abstract': makeObjectPropertySetter(readString),\n        'AccessConstraints': makeObjectPropertySetter(readString),\n        'Fees': makeObjectPropertySetter(readString),\n        'Title': makeObjectPropertySetter(readString),\n        'ServiceTypeVersion': makeObjectPropertySetter(readString),\n        'ServiceType': makeObjectPropertySetter(readString)\n      });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\nconst SERVICE_PROVIDER_PARSERS =\n    makeStructureNS(\n      NAMESPACE_URIS, {\n        'ProviderName': makeObjectPropertySetter(readString),\n        'ProviderSite': makeObjectPropertySetter(readHref),\n        'ServiceContact': makeObjectPropertySetter(readServiceContact)\n      });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The address.\n */\nfunction readAddress(node, objectStack) {\n  return pushParseAndPop({},\n    ADDRESS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The values.\n */\nfunction readAllowedValues(node, objectStack) {\n  return pushParseAndPop({},\n    ALLOWED_VALUES_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The constraint.\n */\nfunction readConstraint(node, objectStack) {\n  const name = node.getAttribute('name');\n  if (!name) {\n    return undefined;\n  }\n  return pushParseAndPop({'name': name},\n    CONSTRAINT_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The contact info.\n */\nfunction readContactInfo(node, objectStack) {\n  return pushParseAndPop({},\n    CONTACT_INFO_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The DCP.\n */\nfunction readDcp(node, objectStack) {\n  return pushParseAndPop({},\n    DCP_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The GET object.\n */\nfunction readGet(node, objectStack) {\n  const href = readHref(node);\n  if (!href) {\n    return undefined;\n  }\n  return pushParseAndPop({'href': href},\n    REQUEST_METHOD_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The HTTP object.\n */\nfunction readHttp(node, objectStack) {\n  return pushParseAndPop({}, HTTP_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The operation.\n */\nfunction readOperation(node, objectStack) {\n  const name = node.getAttribute('name');\n  const value = pushParseAndPop({},\n    OPERATION_PARSERS, node, objectStack);\n  if (!value) {\n    return undefined;\n  }\n  const object = /** @type {Object} */\n      (objectStack[objectStack.length - 1]);\n  object[name] = value;\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The operations metadata.\n */\nfunction readOperationsMetadata(node, objectStack) {\n  return pushParseAndPop({},\n    OPERATIONS_METADATA_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The phone.\n */\nfunction readPhone(node, objectStack) {\n  return pushParseAndPop({},\n    PHONE_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The service identification.\n */\nfunction readServiceIdentification(node, objectStack) {\n  return pushParseAndPop(\n    {}, SERVICE_IDENTIFICATION_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The service contact.\n */\nfunction readServiceContact(node, objectStack) {\n  return pushParseAndPop(\n    {}, SERVICE_CONTACT_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The service provider.\n */\nfunction readServiceProvider(node, objectStack) {\n  return pushParseAndPop(\n    {}, SERVICE_PROVIDER_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {string|undefined} The value.\n */\nfunction readValue(node, objectStack) {\n  return readString(node);\n}\n\n\nexport default OWS;\n"],"names":["const","super","let"],"mappings":"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"}