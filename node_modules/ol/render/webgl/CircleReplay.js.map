{"version":3,"file":"CircleReplay.js","sources":["../../../../src/ol/render/webgl/CircleReplay.js"],"sourcesContent":["/**\n * @module ol/render/webgl/CircleReplay\n */\nimport {getUid} from '../../util.js';\nimport {equals} from '../../array.js';\nimport {asArray} from '../../color.js';\nimport {intersects} from '../../extent.js';\nimport {isEmpty} from '../../obj.js';\nimport {translate} from '../../geom/flat/transform.js';\nimport {fragment, vertex} from './circlereplay/defaultshader.js';\nimport Locations from './circlereplay/defaultshader/Locations.js';\nimport WebGLReplay from './Replay.js';\nimport {DEFAULT_LINEDASH, DEFAULT_LINEDASHOFFSET, DEFAULT_STROKESTYLE,\n  DEFAULT_FILLSTYLE, DEFAULT_LINEWIDTH} from '../webgl.js';\nimport {FLOAT} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\nclass WebGLCircleReplay extends WebGLReplay {\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Max extent.\n   */\n  constructor(tolerance, maxExtent) {\n    super(tolerance, maxExtent);\n\n    /**\n     * @private\n     * @type {import(\"./circlereplay/defaultshader/Locations.js\").default}\n     */\n    this.defaultLocations_ = null;\n\n    /**\n     * @private\n     * @type {Array<Array<Array<number>|number>>}\n     */\n    this.styles_ = [];\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.styleIndices_ = [];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.radius_ = 0;\n\n    /**\n     * @private\n     * @type {{fillColor: (Array<number>|null),\n     *         strokeColor: (Array<number>|null),\n     *         lineDash: Array<number>,\n     *         lineDashOffset: (number|undefined),\n     *         lineWidth: (number|undefined),\n     *         changed: boolean}|null}\n     */\n    this.state_ = {\n      fillColor: null,\n      strokeColor: null,\n      lineDash: null,\n      lineDashOffset: undefined,\n      lineWidth: undefined,\n      changed: false\n    };\n\n  }\n\n  /**\n   * @private\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   */\n  drawCoordinates_(flatCoordinates, offset, end, stride) {\n    let numVertices = this.vertices.length;\n    let numIndices = this.indices.length;\n    let n = numVertices / 4;\n    let i, ii;\n    for (i = offset, ii = end; i < ii; i += stride) {\n      this.vertices[numVertices++] = flatCoordinates[i];\n      this.vertices[numVertices++] = flatCoordinates[i + 1];\n      this.vertices[numVertices++] = 0;\n      this.vertices[numVertices++] = this.radius_;\n\n      this.vertices[numVertices++] = flatCoordinates[i];\n      this.vertices[numVertices++] = flatCoordinates[i + 1];\n      this.vertices[numVertices++] = 1;\n      this.vertices[numVertices++] = this.radius_;\n\n      this.vertices[numVertices++] = flatCoordinates[i];\n      this.vertices[numVertices++] = flatCoordinates[i + 1];\n      this.vertices[numVertices++] = 2;\n      this.vertices[numVertices++] = this.radius_;\n\n      this.vertices[numVertices++] = flatCoordinates[i];\n      this.vertices[numVertices++] = flatCoordinates[i + 1];\n      this.vertices[numVertices++] = 3;\n      this.vertices[numVertices++] = this.radius_;\n\n      this.indices[numIndices++] = n;\n      this.indices[numIndices++] = n + 1;\n      this.indices[numIndices++] = n + 2;\n\n      this.indices[numIndices++] = n + 2;\n      this.indices[numIndices++] = n + 3;\n      this.indices[numIndices++] = n;\n\n      n += 4;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawCircle(circleGeometry, feature) {\n    const radius = circleGeometry.getRadius();\n    const stride = circleGeometry.getStride();\n    if (radius) {\n      this.startIndices.push(this.indices.length);\n      this.startIndicesFeature.push(feature);\n      if (this.state_.changed) {\n        this.styleIndices_.push(this.indices.length);\n        this.state_.changed = false;\n      }\n\n      this.radius_ = radius;\n      let flatCoordinates = circleGeometry.getFlatCoordinates();\n      flatCoordinates = translate(flatCoordinates, 0, 2,\n        stride, -this.origin[0], -this.origin[1]);\n      this.drawCoordinates_(flatCoordinates, 0, 2, stride);\n    } else {\n      if (this.state_.changed) {\n        this.styles_.pop();\n        if (this.styles_.length) {\n          const lastState = this.styles_[this.styles_.length - 1];\n          this.state_.fillColor = /** @type {Array<number>} */ (lastState[0]);\n          this.state_.strokeColor = /** @type {Array<number>} */ (lastState[1]);\n          this.state_.lineWidth = /** @type {number} */ (lastState[2]);\n          this.state_.changed = false;\n        }\n      }\n    }\n  }\n\n  /**\n   * @inheritDoc\n   **/\n  finish(context) {\n    // create, bind, and populate the vertices buffer\n    this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n    // create, bind, and populate the indices buffer\n    this.indicesBuffer = new WebGLBuffer(this.indices);\n\n    this.startIndices.push(this.indices.length);\n\n    //Clean up, if there is nothing to draw\n    if (this.styleIndices_.length === 0 && this.styles_.length > 0) {\n      this.styles_ = [];\n    }\n\n    this.vertices = null;\n    this.indices = null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getDeleteResourcesFunction(context) {\n    // We only delete our stuff here. The shaders and the program may\n    // be used by other CircleReplay instances (for other layers). And\n    // they will be deleted when disposing of the import(\"../../webgl/Context.js\").WebGLContext\n    // object.\n    const verticesBuffer = this.verticesBuffer;\n    const indicesBuffer = this.indicesBuffer;\n    return function() {\n      context.deleteBuffer(verticesBuffer);\n      context.deleteBuffer(indicesBuffer);\n    };\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setUpProgram(gl, context, size, pixelRatio) {\n    // get the program\n    const program = context.getProgram(fragment, vertex);\n\n    // get the locations\n    let locations;\n    if (!this.defaultLocations_) {\n      locations = new Locations(gl, program);\n      this.defaultLocations_ = locations;\n    } else {\n      locations = this.defaultLocations_;\n    }\n\n    context.useProgram(program);\n\n    // enable the vertex attrib arrays\n    gl.enableVertexAttribArray(locations.a_position);\n    gl.vertexAttribPointer(locations.a_position, 2, FLOAT,\n      false, 16, 0);\n\n    gl.enableVertexAttribArray(locations.a_instruction);\n    gl.vertexAttribPointer(locations.a_instruction, 1, FLOAT,\n      false, 16, 8);\n\n    gl.enableVertexAttribArray(locations.a_radius);\n    gl.vertexAttribPointer(locations.a_radius, 1, FLOAT,\n      false, 16, 12);\n\n    // Enable renderer specific uniforms.\n    gl.uniform2fv(locations.u_size, size);\n    gl.uniform1f(locations.u_pixelRatio, pixelRatio);\n\n    return locations;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  shutDownProgram(gl, locations) {\n    gl.disableVertexAttribArray(locations.a_position);\n    gl.disableVertexAttribArray(locations.a_instruction);\n    gl.disableVertexAttribArray(locations.a_radius);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawReplay(gl, context, skippedFeaturesHash, hitDetection) {\n    if (!isEmpty(skippedFeaturesHash)) {\n      this.drawReplaySkipping_(gl, context, skippedFeaturesHash);\n    } else {\n      //Draw by style groups to minimize drawElements() calls.\n      let i, start, end, nextStyle;\n      end = this.startIndices[this.startIndices.length - 1];\n      for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n        start = this.styleIndices_[i];\n        nextStyle = this.styles_[i];\n        this.setFillStyle_(gl, /** @type {Array<number>} */ (nextStyle[0]));\n        this.setStrokeStyle_(gl, /** @type {Array<number>} */ (nextStyle[1]),\n          /** @type {number} */ (nextStyle[2]));\n        this.drawElements(gl, context, start, end);\n        end = start;\n      }\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawHitDetectionReplayOneByOne(gl, context, skippedFeaturesHash, featureCallback, opt_hitExtent) {\n    let i, start, end, nextStyle, groupStart, feature, featureIndex;\n    featureIndex = this.startIndices.length - 2;\n    end = this.startIndices[featureIndex + 1];\n    for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n      nextStyle = this.styles_[i];\n      this.setFillStyle_(gl, /** @type {Array<number>} */ (nextStyle[0]));\n      this.setStrokeStyle_(gl, /** @type {Array<number>} */ (nextStyle[1]),\n        /** @type {number} */ (nextStyle[2]));\n      groupStart = this.styleIndices_[i];\n\n      while (featureIndex >= 0 &&\n          this.startIndices[featureIndex] >= groupStart) {\n        start = this.startIndices[featureIndex];\n        feature = this.startIndicesFeature[featureIndex];\n\n        if (skippedFeaturesHash[getUid(feature)] === undefined &&\n            feature.getGeometry() &&\n            (opt_hitExtent === undefined || intersects(\n              /** @type {Array<number>} */ (opt_hitExtent),\n              feature.getGeometry().getExtent()))) {\n          gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n          this.drawElements(gl, context, start, end);\n\n          const result = featureCallback(feature);\n\n          if (result) {\n            return result;\n          }\n\n        }\n        featureIndex--;\n        end = start;\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * @private\n   * @param {WebGLRenderingContext} gl gl.\n   * @param {import(\"../../webgl/Context.js\").default} context Context.\n   * @param {Object} skippedFeaturesHash Ids of features to skip.\n   */\n  drawReplaySkipping_(gl, context, skippedFeaturesHash) {\n    let i, start, end, nextStyle, groupStart, feature, featureIndex, featureStart;\n    featureIndex = this.startIndices.length - 2;\n    end = start = this.startIndices[featureIndex + 1];\n    for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n      nextStyle = this.styles_[i];\n      this.setFillStyle_(gl, /** @type {Array<number>} */ (nextStyle[0]));\n      this.setStrokeStyle_(gl, /** @type {Array<number>} */ (nextStyle[1]),\n        /** @type {number} */ (nextStyle[2]));\n      groupStart = this.styleIndices_[i];\n\n      while (featureIndex >= 0 &&\n          this.startIndices[featureIndex] >= groupStart) {\n        featureStart = this.startIndices[featureIndex];\n        feature = this.startIndicesFeature[featureIndex];\n\n        if (skippedFeaturesHash[getUid(feature)]) {\n          if (start !== end) {\n            this.drawElements(gl, context, start, end);\n          }\n          end = featureStart;\n        }\n        featureIndex--;\n        start = featureStart;\n      }\n      if (start !== end) {\n        this.drawElements(gl, context, start, end);\n      }\n      start = end = groupStart;\n    }\n  }\n\n  /**\n   * @private\n   * @param {WebGLRenderingContext} gl gl.\n   * @param {Array<number>} color Color.\n   */\n  setFillStyle_(gl, color) {\n    gl.uniform4fv(this.defaultLocations_.u_fillColor, color);\n  }\n\n  /**\n   * @private\n   * @param {WebGLRenderingContext} gl gl.\n   * @param {Array<number>} color Color.\n   * @param {number} lineWidth Line width.\n   */\n  setStrokeStyle_(gl, color, lineWidth) {\n    gl.uniform4fv(this.defaultLocations_.u_strokeColor, color);\n    gl.uniform1f(this.defaultLocations_.u_lineWidth, lineWidth);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setFillStrokeStyle(fillStyle, strokeStyle) {\n    let strokeStyleColor, strokeStyleWidth;\n    if (strokeStyle) {\n      const strokeStyleLineDash = strokeStyle.getLineDash();\n      this.state_.lineDash = strokeStyleLineDash ?\n        strokeStyleLineDash : DEFAULT_LINEDASH;\n      const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n      this.state_.lineDashOffset = strokeStyleLineDashOffset ?\n        strokeStyleLineDashOffset : DEFAULT_LINEDASHOFFSET;\n      strokeStyleColor = strokeStyle.getColor();\n      if (!(strokeStyleColor instanceof CanvasGradient) &&\n          !(strokeStyleColor instanceof CanvasPattern)) {\n        strokeStyleColor = asArray(strokeStyleColor).map(function(c, i) {\n          return i != 3 ? c / 255 : c;\n        }) || DEFAULT_STROKESTYLE;\n      } else {\n        strokeStyleColor = DEFAULT_STROKESTYLE;\n      }\n      strokeStyleWidth = strokeStyle.getWidth();\n      strokeStyleWidth = strokeStyleWidth !== undefined ?\n        strokeStyleWidth : DEFAULT_LINEWIDTH;\n    } else {\n      strokeStyleColor = [0, 0, 0, 0];\n      strokeStyleWidth = 0;\n    }\n    let fillStyleColor = fillStyle ? fillStyle.getColor() : [0, 0, 0, 0];\n    if (!(fillStyleColor instanceof CanvasGradient) &&\n        !(fillStyleColor instanceof CanvasPattern)) {\n      fillStyleColor = asArray(fillStyleColor).map(function(c, i) {\n        return i != 3 ? c / 255 : c;\n      }) || DEFAULT_FILLSTYLE;\n    } else {\n      fillStyleColor = DEFAULT_FILLSTYLE;\n    }\n    if (!this.state_.strokeColor || !equals(this.state_.strokeColor, strokeStyleColor) ||\n        !this.state_.fillColor || !equals(this.state_.fillColor, fillStyleColor) ||\n        this.state_.lineWidth !== strokeStyleWidth) {\n      this.state_.changed = true;\n      this.state_.fillColor = fillStyleColor;\n      this.state_.strokeColor = strokeStyleColor;\n      this.state_.lineWidth = strokeStyleWidth;\n      this.styles_.push([fillStyleColor, strokeStyleColor, strokeStyleWidth]);\n    }\n  }\n}\n\n\nexport default WebGLCircleReplay;\n"],"names":["super","let","const"],"mappings":"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"}