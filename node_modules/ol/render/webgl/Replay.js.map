{"version":3,"file":"Replay.js","sources":["../../../../src/ol/render/webgl/Replay.js"],"sourcesContent":["/**\n * @module ol/render/webgl/Replay\n */\nimport {abstract} from '../../util.js';\nimport {getCenter} from '../../extent.js';\nimport VectorContext from '../VectorContext.js';\nimport {\n  create as createTransform,\n  reset as resetTransform,\n  rotate as rotateTransform,\n  scale as scaleTransform,\n  translate as translateTransform\n} from '../../transform.js';\nimport {create, fromTransform} from '../../vec/mat4.js';\nimport {ARRAY_BUFFER, ELEMENT_ARRAY_BUFFER, TRIANGLES,\n  UNSIGNED_INT, UNSIGNED_SHORT} from '../../webgl.js';\n\nclass WebGLReplay extends VectorContext {\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Max extent.\n   */\n  constructor(tolerance, maxExtent) {\n    super();\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.tolerance = tolerance;\n\n    /**\n     * @protected\n     * @const\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.maxExtent = maxExtent;\n\n    /**\n     * The origin of the coordinate system for the point coordinates sent to\n     * the GPU. To eliminate jitter caused by precision problems in the GPU\n     * we use the \"Rendering Relative to Eye\" technique described in the \"3D\n     * Engine Design for Virtual Globes\" book.\n     * @protected\n     * @type {import(\"../../coordinate.js\").Coordinate}\n     */\n    this.origin = getCenter(maxExtent);\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.projectionMatrix_ = createTransform();\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.offsetRotateMatrix_ = createTransform();\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.offsetScaleMatrix_ = createTransform();\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.tmpMat4_ = create();\n\n    /**\n     * @protected\n     * @type {Array<number>}\n     */\n    this.indices = [];\n\n    /**\n     * @protected\n     * @type {?import(\"../../webgl/Buffer.js\").default}\n     */\n    this.indicesBuffer = null;\n\n    /**\n     * Start index per feature (the index).\n     * @protected\n     * @type {Array<number>}\n     */\n    this.startIndices = [];\n\n    /**\n     * Start index per feature (the feature).\n     * @protected\n     * @type {Array<import(\"../../Feature.js\").default|import(\"../Feature.js\").default>}\n     */\n    this.startIndicesFeature = [];\n\n    /**\n     * @protected\n     * @type {Array<number>}\n     */\n    this.vertices = [];\n\n    /**\n     * @protected\n     * @type {?import(\"../../webgl/Buffer.js\").default}\n     */\n    this.verticesBuffer = null;\n\n    /**\n     * Optional parameter for PolygonReplay instances.\n     * @protected\n     * @type {import(\"./LineStringReplay.js\").default|undefined}\n     */\n    this.lineStringReplay = undefined;\n\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../../webgl/Context.js\").default} context WebGL context.\n   * @return {function()} Delete resources function.\n   */\n  getDeleteResourcesFunction(context) {\n    return abstract();\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../../webgl/Context.js\").default} context Context.\n   */\n  finish(context) {\n    abstract();\n  }\n\n  /**\n   * @abstract\n   * @protected\n   * @param {WebGLRenderingContext} gl gl.\n   * @param {import(\"../../webgl/Context.js\").default} context Context.\n   * @param {import(\"../../size.js\").Size} size Size.\n   * @param {number} pixelRatio Pixel ratio.\n   * @return {import(\"./circlereplay/defaultshader/Locations.js\").default|\n     import(\"./linestringreplay/defaultshader/Locations.js\").default|\n     import(\"./polygonreplay/defaultshader/Locations.js\").default|\n     import(\"./texturereplay/defaultshader/Locations.js\").default} Locations.\n   */\n  setUpProgram(gl, context, size, pixelRatio) {\n    return abstract();\n  }\n\n  /**\n   * @abstract\n   * @protected\n   * @param {WebGLRenderingContext} gl gl.\n   * @param {import(\"./circlereplay/defaultshader/Locations.js\").default|\n     import(\"./linestringreplay/defaultshader/Locations.js\").default|\n     import(\"./polygonreplay/defaultshader/Locations.js\").default|\n     import(\"./texturereplay/defaultshader/Locations.js\").default} locations Locations.\n   */\n  shutDownProgram(gl, locations) {\n    abstract();\n  }\n\n  /**\n   * @abstract\n   * @protected\n   * @param {WebGLRenderingContext} gl gl.\n   * @param {import(\"../../webgl/Context.js\").default} context Context.\n   * @param {Object<string, boolean>} skippedFeaturesHash Ids of features to skip.\n   * @param {boolean} hitDetection Hit detection mode.\n   */\n  drawReplay(gl, context, skippedFeaturesHash, hitDetection) {\n    abstract();\n  }\n\n  /**\n   * @abstract\n   * @protected\n   * @param {WebGLRenderingContext} gl gl.\n   * @param {import(\"../../webgl/Context.js\").default} context Context.\n   * @param {Object<string, boolean>} skippedFeaturesHash Ids of features to skip.\n   * @param {function((import(\"../../Feature.js\").default|import(\"../Feature.js\").default)): T|undefined} featureCallback Feature callback.\n   * @param {import(\"../../extent.js\").Extent=} opt_hitExtent Hit extent: Only features intersecting this extent are checked.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  drawHitDetectionReplayOneByOne(gl, context, skippedFeaturesHash, featureCallback, opt_hitExtent) {\n    return abstract();\n  }\n\n  /**\n   * @protected\n   * @param {WebGLRenderingContext} gl gl.\n   * @param {import(\"../../webgl/Context.js\").default} context Context.\n   * @param {Object<string, boolean>} skippedFeaturesHash Ids of features to skip.\n   * @param {function((import(\"../../Feature.js\").default|import(\"../Feature.js\").default)): T|undefined} featureCallback Feature callback.\n   * @param {boolean} oneByOne Draw features one-by-one for the hit-detecion.\n   * @param {import(\"../../extent.js\").Extent=} opt_hitExtent Hit extent: Only features intersecting this extent are checked.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  drawHitDetectionReplay(gl, context, skippedFeaturesHash, featureCallback, oneByOne, opt_hitExtent) {\n    if (!oneByOne) {\n      // draw all hit-detection features in \"once\" (by texture group)\n      return this.drawHitDetectionReplayAll(gl, context,\n        skippedFeaturesHash, featureCallback);\n    } else {\n      // draw hit-detection features one by one\n      return this.drawHitDetectionReplayOneByOne(gl, context,\n        skippedFeaturesHash, featureCallback, opt_hitExtent);\n    }\n  }\n\n  /**\n   * @protected\n   * @param {WebGLRenderingContext} gl gl.\n   * @param {import(\"../../webgl/Context.js\").default} context Context.\n   * @param {Object<string, boolean>} skippedFeaturesHash Ids of features to skip.\n   * @param {function((import(\"../../Feature.js\").default|import(\"../Feature.js\").default)): T|undefined} featureCallback Feature callback.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  drawHitDetectionReplayAll(gl, context, skippedFeaturesHash, featureCallback) {\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    this.drawReplay(gl, context, skippedFeaturesHash, true);\n\n    const result = featureCallback(null);\n    if (result) {\n      return result;\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * @param {import(\"../../webgl/Context.js\").default} context Context.\n   * @param {import(\"../../coordinate.js\").Coordinate} center Center.\n   * @param {number} resolution Resolution.\n   * @param {number} rotation Rotation.\n   * @param {import(\"../../size.js\").Size} size Size.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {number} opacity Global opacity.\n   * @param {Object<string, boolean>} skippedFeaturesHash Ids of features to skip.\n   * @param {function((import(\"../../Feature.js\").default|import(\"../Feature.js\").default)): T|undefined} featureCallback Feature callback.\n   * @param {boolean} oneByOne Draw features one-by-one for the hit-detecion.\n   * @param {import(\"../../extent.js\").Extent=} opt_hitExtent Hit extent: Only features intersecting this extent are checked.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  replay(\n    context,\n    center,\n    resolution,\n    rotation,\n    size,\n    pixelRatio,\n    opacity,\n    skippedFeaturesHash,\n    featureCallback,\n    oneByOne,\n    opt_hitExtent\n  ) {\n    const gl = context.getGL();\n    let tmpStencil, tmpStencilFunc, tmpStencilMaskVal, tmpStencilRef, tmpStencilMask,\n        tmpStencilOpFail, tmpStencilOpPass, tmpStencilOpZFail;\n\n    if (this.lineStringReplay) {\n      tmpStencil = gl.isEnabled(gl.STENCIL_TEST);\n      tmpStencilFunc = gl.getParameter(gl.STENCIL_FUNC);\n      tmpStencilMaskVal = gl.getParameter(gl.STENCIL_VALUE_MASK);\n      tmpStencilRef = gl.getParameter(gl.STENCIL_REF);\n      tmpStencilMask = gl.getParameter(gl.STENCIL_WRITEMASK);\n      tmpStencilOpFail = gl.getParameter(gl.STENCIL_FAIL);\n      tmpStencilOpPass = gl.getParameter(gl.STENCIL_PASS_DEPTH_PASS);\n      tmpStencilOpZFail = gl.getParameter(gl.STENCIL_PASS_DEPTH_FAIL);\n\n      gl.enable(gl.STENCIL_TEST);\n      gl.clear(gl.STENCIL_BUFFER_BIT);\n      gl.stencilMask(255);\n      gl.stencilFunc(gl.ALWAYS, 1, 255);\n      gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\n\n      this.lineStringReplay.replay(context,\n        center, resolution, rotation, size, pixelRatio,\n        opacity, skippedFeaturesHash,\n        featureCallback, oneByOne, opt_hitExtent);\n\n      gl.stencilMask(0);\n      gl.stencilFunc(gl.NOTEQUAL, 1, 255);\n    }\n\n    context.bindBuffer(ARRAY_BUFFER, this.verticesBuffer);\n\n    context.bindBuffer(ELEMENT_ARRAY_BUFFER, this.indicesBuffer);\n\n    const locations = this.setUpProgram(gl, context, size, pixelRatio);\n\n    // set the \"uniform\" values\n    const projectionMatrix = resetTransform(this.projectionMatrix_);\n    scaleTransform(projectionMatrix, 2 / (resolution * size[0]), 2 / (resolution * size[1]));\n    rotateTransform(projectionMatrix, -rotation);\n    translateTransform(projectionMatrix, -(center[0] - this.origin[0]), -(center[1] - this.origin[1]));\n\n    const offsetScaleMatrix = resetTransform(this.offsetScaleMatrix_);\n    scaleTransform(offsetScaleMatrix, 2 / size[0], 2 / size[1]);\n\n    const offsetRotateMatrix = resetTransform(this.offsetRotateMatrix_);\n    if (rotation !== 0) {\n      rotateTransform(offsetRotateMatrix, -rotation);\n    }\n\n    gl.uniformMatrix4fv(locations.u_projectionMatrix, false,\n      fromTransform(this.tmpMat4_, projectionMatrix));\n    gl.uniformMatrix4fv(locations.u_offsetScaleMatrix, false,\n      fromTransform(this.tmpMat4_, offsetScaleMatrix));\n    gl.uniformMatrix4fv(locations.u_offsetRotateMatrix, false,\n      fromTransform(this.tmpMat4_, offsetRotateMatrix));\n    gl.uniform1f(locations.u_opacity, opacity);\n\n    // draw!\n    let result;\n    if (featureCallback === undefined) {\n      this.drawReplay(gl, context, skippedFeaturesHash, false);\n    } else {\n      // draw feature by feature for the hit-detection\n      result = this.drawHitDetectionReplay(gl, context, skippedFeaturesHash,\n        featureCallback, oneByOne, opt_hitExtent);\n    }\n\n    // disable the vertex attrib arrays\n    this.shutDownProgram(gl, locations);\n\n    if (this.lineStringReplay) {\n      if (!tmpStencil) {\n        gl.disable(gl.STENCIL_TEST);\n      }\n      gl.clear(gl.STENCIL_BUFFER_BIT);\n      gl.stencilFunc(/** @type {number} */ (tmpStencilFunc),\n        /** @type {number} */ (tmpStencilRef), /** @type {number} */ (tmpStencilMaskVal));\n      gl.stencilMask(/** @type {number} */ (tmpStencilMask));\n      gl.stencilOp(/** @type {number} */ (tmpStencilOpFail),\n        /** @type {number} */ (tmpStencilOpZFail), /** @type {number} */ (tmpStencilOpPass));\n    }\n\n    return result;\n  }\n\n  /**\n   * @protected\n   * @param {WebGLRenderingContext} gl gl.\n   * @param {import(\"../../webgl/Context.js\").default} context Context.\n   * @param {number} start Start index.\n   * @param {number} end End index.\n   */\n  drawElements(gl, context, start, end) {\n    const elementType = context.hasOESElementIndexUint ?\n      UNSIGNED_INT : UNSIGNED_SHORT;\n    const elementSize = context.hasOESElementIndexUint ? 4 : 2;\n\n    const numItems = end - start;\n    const offsetInBytes = start * elementSize;\n    gl.drawElements(TRIANGLES, numItems, elementType, offsetInBytes);\n  }\n}\n\n\nexport default WebGLReplay;\n"],"names":["super","const","let"],"mappings":"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"}